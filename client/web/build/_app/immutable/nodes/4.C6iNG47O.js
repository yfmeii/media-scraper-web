import{s as Qt,r as et,o as Yt,f as Zt,d as Ye,n as tt,e as mt}from"../chunks/UNimWYyO.js";import{S as Jt,i as Xt,d as o,k as We,l as Se,v as Xe,s as Ee,m as r,w as ft,D as Nt,a as se,b as l,r as pe,c as u,e as f,o as re,g as y,f as J,x as _t,h as d,p as le,j as E,t as X,z as Le,n as he,y as $t,q as Gt,E as jt,B as yt,C as ht}from"../chunks/rPDuuC_j.js";import{j as Je,k as es,s as ts,r as pt,e as vt,d as ss,i as rs}from"../chunks/p95UxV7J.js";import{q as Ge,a as bt,f as $e,s as gt}from"../chunks/Crnc-Z4a.js";function At(n,e,t){const s=n.slice();return s[61]=e[t],s}function Lt(n,e,t){const s=n.slice();return s[64]=e[t],s}function Ot(n){let e,t;return{c(){e=d("span"),t=X(n[15]),this.h()},l(s){e=u(s,"SPAN",{class:!0});var a=f(e);t=J(a,n[15]),a.forEach(o),this.h()},h(){r(e,"class","text-sm text-muted-foreground")},m(s,a){se(s,e,a),l(e,t)},p(s,a){a[0]&32768&&Ee(t,s[15])},d(s){s&&o(e)}}}function ls(n){let e,t,s,a,i,c,m,k,Y="海报",C,W,q="电影名称",D,g,N="年份",U,I,R="状态",H,B,T="完整性",M,p,w="操作",V,b,j,L,G=vt(n[19]),z=[];for(let O=0;O<G.length;O+=1)z[O]=Ht(Lt(n,G,O));return{c(){e=d("table"),t=d("thead"),s=d("tr"),a=d("th"),i=d("input"),m=E(),k=d("th"),k.textContent=Y,C=E(),W=d("th"),W.textContent=q,D=E(),g=d("th"),g.textContent=N,U=E(),I=d("th"),I.textContent=R,H=E(),B=d("th"),B.textContent=T,M=E(),p=d("th"),p.textContent=w,V=E(),b=d("tbody");for(let O=0;O<z.length;O+=1)z[O].c();this.h()},l(O){e=u(O,"TABLE",{class:!0});var P=f(e);t=u(P,"THEAD",{class:!0});var v=f(t);s=u(v,"TR",{class:!0});var A=f(s);a=u(A,"TH",{class:!0});var Q=f(a);i=u(Q,"INPUT",{type:!0,class:!0}),Q.forEach(o),m=y(A),k=u(A,"TH",{class:!0,"data-svelte-h":!0}),he(k)!=="svelte-4t8ua8"&&(k.textContent=Y),C=y(A),W=u(A,"TH",{class:!0,"data-svelte-h":!0}),he(W)!=="svelte-maqrme"&&(W.textContent=q),D=y(A),g=u(A,"TH",{class:!0,"data-svelte-h":!0}),he(g)!=="svelte-jwn82m"&&(g.textContent=N),U=y(A),I=u(A,"TH",{class:!0,"data-svelte-h":!0}),he(I)!=="svelte-sg6ah"&&(I.textContent=R),H=y(A),B=u(A,"TH",{class:!0,"data-svelte-h":!0}),he(B)!=="svelte-fjgdw4"&&(B.textContent=T),M=y(A),p=u(A,"TH",{class:!0,"data-svelte-h":!0}),he(p)!=="svelte-1i6w87u"&&(p.textContent=w),A.forEach(o),v.forEach(o),V=y(P),b=u(P,"TBODY",{});var ce=f(b);for(let de=0;de<z.length;de+=1)z[de].l(ce);ce.forEach(o),P.forEach(o),this.h()},h(){r(i,"type","checkbox"),r(i,"class","h-4 w-4 rounded border-input accent-primary"),i.checked=c=n[4].size===n[19].length&&n[19].length>0,r(a,"class","w-12 p-3 text-left"),r(k,"class","w-16 p-3 text-left font-medium"),r(W,"class","p-3 text-left font-medium"),r(g,"class","w-20 p-3 text-left font-medium"),r(I,"class","w-32 p-3 text-left font-medium"),r(B,"class","w-40 p-3 text-left font-medium"),r(p,"class","w-40 p-3 text-left font-medium"),r(s,"class","border-b border-border text-xs text-muted-foreground"),r(t,"class","bg-card"),r(e,"class","w-full")},m(O,P){se(O,e,P),l(e,t),l(t,s),l(s,a),l(a,i),l(s,m),l(s,k),l(s,C),l(s,W),l(s,D),l(s,g),l(s,U),l(s,I),l(s,H),l(s,B),l(s,M),l(s,p),l(e,V),l(e,b);for(let v=0;v<z.length;v+=1)z[v]&&z[v].m(b,null);j||(L=pe(i,"change",n[21]),j=!0)},p(O,P){if(P[0]&524304&&c!==(c=O[4].size===O[19].length&&O[19].length>0)&&(i.checked=c),P[0]&39321616){G=vt(O[19]);let v;for(v=0;v<G.length;v+=1){const A=Lt(O,G,v);z[v]?z[v].p(A,P):(z[v]=Ht(A),z[v].c(),z[v].m(b,null))}for(;v<z.length;v+=1)z[v].d(1);z.length=G.length}},d(O){O&&o(e),Gt(z,O),j=!1,L()}}}function ns(n){let e,t="没有找到符合条件的电影";return{c(){e=d("div"),e.textContent=t,this.h()},l(s){e=u(s,"DIV",{class:!0,"data-svelte-h":!0}),he(e)!=="svelte-esrfcz"&&(e.textContent=t),this.h()},h(){r(e,"class","p-8 text-center text-muted-foreground")},m(s,a){se(s,e,a)},p:tt,d(s){s&&o(e)}}}function as(n){let e,t="加载中...";return{c(){e=d("div"),e.textContent=t,this.h()},l(s){e=u(s,"DIV",{class:!0,"data-svelte-h":!0}),he(e)!=="svelte-1x1v86g"&&(e.textContent=t),this.h()},h(){r(e,"class","p-8 text-center text-muted-foreground")},m(s,a){se(s,e,a)},p:tt,d(s){s&&o(e)}}}function os(n){let e,t='<svg class="h-4 w-4 text-muted-foreground" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><path d="m15 9-6 6"></path><path d="m9 9 6 6"></path></svg>';return{c(){e=d("div"),e.innerHTML=t,this.h()},l(s){e=u(s,"DIV",{class:!0,"data-svelte-h":!0}),he(e)!=="svelte-s2gtmp"&&(e.innerHTML=t),this.h()},h(){r(e,"class","flex h-12 w-9 items-center justify-center rounded bg-muted")},m(s,a){se(s,e,a)},p:tt,d(s){s&&o(e)}}}function is(n){let e,t='<svg class="h-5 w-5 text-primary" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"></rect><circle cx="9" cy="9" r="2"></circle><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"></path></svg>';return{c(){e=d("div"),e.innerHTML=t,this.h()},l(s){e=u(s,"DIV",{class:!0,"data-svelte-h":!0}),he(e)!=="svelte-1xxpjcy"&&(e.innerHTML=t),this.h()},h(){r(e,"class","flex h-12 w-9 items-center justify-center rounded bg-primary/10")},m(s,a){se(s,e,a)},p:tt,d(s){s&&o(e)}}}function cs(n){let e,t,s;return{c(){e=d("img"),this.h()},l(a){e=u(a,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){mt(e.src,t=n[64].posterPath)||r(e,"src",t),r(e,"alt",s=n[64].name),r(e,"class","h-12 w-9 object-cover rounded")},m(a,i){se(a,e,i)},p(a,i){i[0]&524288&&!mt(e.src,t=a[64].posterPath)&&r(e,"src",t),i[0]&524288&&s!==(s=a[64].name)&&r(e,"alt",s)},d(a){a&&o(e)}}}function us(n){let e,t,s,a,i;return{c(){e=le("svg"),t=le("circle"),s=le("path"),a=le("path"),i=X(`
                    未刮削`),this.h()},l(c){e=re(c,"svg",{class:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var m=f(e);t=re(m,"circle",{cx:!0,cy:!0,r:!0}),f(t).forEach(o),s=re(m,"path",{d:!0}),f(s).forEach(o),a=re(m,"path",{d:!0}),f(a).forEach(o),m.forEach(o),i=J(c,`
                    未刮削`),this.h()},h(){r(t,"cx","12"),r(t,"cy","12"),r(t,"r","10"),r(s,"d","m15 9-6 6"),r(a,"d","m9 9 6 6"),r(e,"class","h-3 w-3"),r(e,"viewBox","0 0 24 24"),r(e,"fill","none"),r(e,"stroke","currentColor"),r(e,"stroke-width","2")},m(c,m){se(c,e,m),l(e,t),l(e,s),l(e,a),se(c,i,m)},d(c){c&&(o(e),o(i))}}}function ds(n){let e,t,s,a;return{c(){e=le("svg"),t=le("path"),s=le("path"),a=X(`
                    已刮削`),this.h()},l(i){e=re(i,"svg",{class:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var c=f(e);t=re(c,"path",{d:!0}),f(t).forEach(o),s=re(c,"path",{d:!0}),f(s).forEach(o),c.forEach(o),a=J(i,`
                    已刮削`),this.h()},h(){r(t,"d","M22 11.08V12a10 10 0 1 1-5.93-9.14"),r(s,"d","m9 11 3 3L22 4"),r(e,"class","h-3 w-3"),r(e,"viewBox","0 0 24 24"),r(e,"fill","none"),r(e,"stroke","currentColor"),r(e,"stroke-width","2")},m(i,c){se(i,e,c),l(e,t),l(e,s),se(i,a,c)},d(i){i&&(o(e),o(a))}}}function fs(n){let e,t,s,a;return{c(){e=le("svg"),t=le("circle"),s=le("path"),a=le("path"),this.h()},l(i){e=re(i,"svg",{class:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var c=f(e);t=re(c,"circle",{cx:!0,cy:!0,r:!0}),f(t).forEach(o),s=re(c,"path",{d:!0}),f(s).forEach(o),a=re(c,"path",{d:!0}),f(a).forEach(o),c.forEach(o),this.h()},h(){r(t,"cx","12"),r(t,"cy","12"),r(t,"r","10"),r(s,"d","m15 9-6 6"),r(a,"d","m9 9 6 6"),r(e,"class","h-3 w-3"),r(e,"viewBox","0 0 24 24"),r(e,"fill","none"),r(e,"stroke","currentColor"),r(e,"stroke-width","2")},m(i,c){se(i,e,c),l(e,t),l(e,s),l(e,a)},d(i){i&&o(e)}}}function hs(n){let e,t,s;return{c(){e=le("svg"),t=le("path"),s=le("path"),this.h()},l(a){e=re(a,"svg",{class:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var i=f(e);t=re(i,"path",{d:!0}),f(t).forEach(o),s=re(i,"path",{d:!0}),f(s).forEach(o),i.forEach(o),this.h()},h(){r(t,"d","M22 11.08V12a10 10 0 1 1-5.93-9.14"),r(s,"d","m9 11 3 3L22 4"),r(e,"class","h-3 w-3"),r(e,"viewBox","0 0 24 24"),r(e,"fill","none"),r(e,"stroke","currentColor"),r(e,"stroke-width","2")},m(a,i){se(a,e,i),l(e,t),l(e,s)},d(a){a&&o(e)}}}function ps(n){let e,t,s,a;return{c(){e=le("svg"),t=le("circle"),s=le("path"),a=le("path"),this.h()},l(i){e=re(i,"svg",{class:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var c=f(e);t=re(c,"circle",{cx:!0,cy:!0,r:!0}),f(t).forEach(o),s=re(c,"path",{d:!0}),f(s).forEach(o),a=re(c,"path",{d:!0}),f(a).forEach(o),c.forEach(o),this.h()},h(){r(t,"cx","12"),r(t,"cy","12"),r(t,"r","10"),r(s,"d","m15 9-6 6"),r(a,"d","m9 9 6 6"),r(e,"class","h-3 w-3"),r(e,"viewBox","0 0 24 24"),r(e,"fill","none"),r(e,"stroke","currentColor"),r(e,"stroke-width","2")},m(i,c){se(i,e,c),l(e,t),l(e,s),l(e,a)},d(i){i&&o(e)}}}function ms(n){let e,t,s;return{c(){e=le("svg"),t=le("path"),s=le("path"),this.h()},l(a){e=re(a,"svg",{class:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var i=f(e);t=re(i,"path",{d:!0}),f(t).forEach(o),s=re(i,"path",{d:!0}),f(s).forEach(o),i.forEach(o),this.h()},h(){r(t,"d","M22 11.08V12a10 10 0 1 1-5.93-9.14"),r(s,"d","m9 11 3 3L22 4"),r(e,"class","h-3 w-3"),r(e,"viewBox","0 0 24 24"),r(e,"fill","none"),r(e,"stroke","currentColor"),r(e,"stroke-width","2")},m(a,i){se(a,e,i),l(e,t),l(e,s)},d(a){a&&o(e)}}}function Ht(n){let e,t,s,a,i,c,m,k,Y,C=n[64].name+"",W,q,D,g=(n[64].year||"-")+"",N,U,I,R,H,B,T,M,p,w,V,b,j,L,G,z,O,P,v,A="详情",Q,ce,de="匹配",ge,ke,me,ve;function De(){return n[37](n[64])}function _e(ae,F){var ee;return ae[64].posterPath?cs:(ee=ae[64].assets)!=null&&ee.hasPoster?is:os}let Ce=_e(n),ue=Ce(n);function we(ae,F){return ae[64].isProcessed?ds:us}let $=we(n),S=$(n);function ne(ae,F){var ee;return(ee=ae[64].assets)!=null&&ee.hasPoster?hs:fs}let ie=ne(n),_=ie(n);function x(ae,F){var ee;return(ee=ae[64].assets)!=null&&ee.hasNfo?ms:ps}let oe=x(n),be=oe(n);function Pe(){return n[38](n[64])}function Me(){return n[39](n[64])}function xe(...ae){return n[40](n[64],...ae)}function Be(){return n[41](n[64])}return{c(){e=d("tr"),t=d("td"),s=d("input"),i=E(),c=d("td"),ue.c(),m=E(),k=d("td"),Y=d("div"),W=X(C),q=E(),D=d("td"),N=X(g),U=E(),I=d("td"),R=d("span"),S.c(),B=E(),T=d("td"),M=d("div"),p=d("span"),_.c(),w=X(`
                    海报`),b=E(),j=d("span"),be.c(),L=X(`
                    NFO`),z=E(),O=d("td"),P=d("div"),v=d("button"),v.textContent=A,Q=E(),ce=d("button"),ce.textContent=de,ge=E(),this.h()},l(ae){e=u(ae,"TR",{class:!0});var F=f(e);t=u(F,"TD",{class:!0});var ee=f(t);s=u(ee,"INPUT",{type:!0,class:!0}),ee.forEach(o),i=y(F),c=u(F,"TD",{class:!0});var Te=f(c);ue.l(Te),Te.forEach(o),m=y(F),k=u(F,"TD",{class:!0});var Ue=f(k);Y=u(Ue,"DIV",{class:!0});var h=f(Y);W=J(h,C),h.forEach(o),Ue.forEach(o),q=y(F),D=u(F,"TD",{class:!0});var Z=f(D);N=J(Z,g),Z.forEach(o),U=y(F),I=u(F,"TD",{class:!0});var K=f(I);R=u(K,"SPAN",{class:!0});var fe=f(R);S.l(fe),fe.forEach(o),K.forEach(o),B=y(F),T=u(F,"TD",{class:!0});var Ie=f(T);M=u(Ie,"DIV",{class:!0});var je=f(M);p=u(je,"SPAN",{class:!0});var Ae=f(p);_.l(Ae),w=J(Ae,`
                    海报`),Ae.forEach(o),b=y(je),j=u(je,"SPAN",{class:!0});var Ke=f(j);be.l(Ke),L=J(Ke,`
                    NFO`),Ke.forEach(o),je.forEach(o),Ie.forEach(o),z=y(F),O=u(F,"TD",{class:!0});var ze=f(O);P=u(ze,"DIV",{class:!0});var Oe=f(P);v=u(Oe,"BUTTON",{class:!0,"data-svelte-h":!0}),he(v)!=="svelte-1f2hms4"&&(v.textContent=A),Q=y(Oe),ce=u(Oe,"BUTTON",{class:!0,"data-svelte-h":!0}),he(ce)!=="svelte-1ah67l1"&&(ce.textContent=de),Oe.forEach(o),ze.forEach(o),ge=y(F),F.forEach(o),this.h()},h(){var ae,F;r(s,"type","checkbox"),r(s,"class","h-4 w-4 rounded border-input accent-primary"),s.checked=a=n[4].has(n[64].path),r(t,"class","p-3"),r(c,"class","p-3"),r(Y,"class","font-medium"),r(k,"class","p-3"),r(D,"class","p-3 text-muted-foreground"),r(R,"class",H="inline-flex items-center gap-1 rounded-full border px-2.5 py-0.5 text-xs font-semibold "+(n[64].isProcessed?"text-green-500 border-green-500/50":"text-red-500 border-red-500/50")),r(I,"class","p-3"),r(p,"class",V="flex items-center gap-1 text-xs "+((ae=n[64].assets)!=null&&ae.hasPoster?"text-green-500":"text-red-500")),r(j,"class",G="flex items-center gap-1 text-xs "+((F=n[64].assets)!=null&&F.hasNfo?"text-green-500":"text-red-500")),r(M,"class","flex items-center gap-2"),r(T,"class","p-3"),r(v,"class","inline-flex items-center justify-center rounded-md text-xs font-medium h-7 px-2 border border-input bg-background hover:bg-accent"),r(ce,"class","inline-flex items-center justify-center rounded-md text-xs font-medium h-7 px-2 border border-input bg-background hover:bg-accent"),r(P,"class","flex gap-1"),r(O,"class","p-3"),r(e,"class",ke="border-b border-border hover:bg-accent/50 cursor-pointer "+(n[4].has(n[64].path)?"bg-accent/30 border-l-2 border-l-primary":""))},m(ae,F){se(ae,e,F),l(e,t),l(t,s),l(e,i),l(e,c),ue.m(c,null),l(e,m),l(e,k),l(k,Y),l(Y,W),l(e,q),l(e,D),l(D,N),l(e,U),l(e,I),l(I,R),S.m(R,null),l(e,B),l(e,T),l(T,M),l(M,p),_.m(p,null),l(p,w),l(M,b),l(M,j),be.m(j,null),l(j,L),l(e,z),l(e,O),l(O,P),l(P,v),l(P,Q),l(P,ce),l(e,ge),me||(ve=[pe(s,"click",yt(De)),pe(v,"click",yt(Pe)),pe(ce,"click",yt(Me)),pe(e,"click",xe),pe(e,"dblclick",Be)],me=!0)},p(ae,F){var ee,Te;n=ae,F[0]&524304&&a!==(a=n[4].has(n[64].path))&&(s.checked=a),Ce===(Ce=_e(n))&&ue?ue.p(n,F):(ue.d(1),ue=Ce(n),ue&&(ue.c(),ue.m(c,null))),F[0]&524288&&C!==(C=n[64].name+"")&&Ee(W,C),F[0]&524288&&g!==(g=(n[64].year||"-")+"")&&Ee(N,g),$!==($=we(n))&&(S.d(1),S=$(n),S&&(S.c(),S.m(R,null))),F[0]&524288&&H!==(H="inline-flex items-center gap-1 rounded-full border px-2.5 py-0.5 text-xs font-semibold "+(n[64].isProcessed?"text-green-500 border-green-500/50":"text-red-500 border-red-500/50"))&&r(R,"class",H),ie!==(ie=ne(n))&&(_.d(1),_=ie(n),_&&(_.c(),_.m(p,w))),F[0]&524288&&V!==(V="flex items-center gap-1 text-xs "+((ee=n[64].assets)!=null&&ee.hasPoster?"text-green-500":"text-red-500"))&&r(p,"class",V),oe!==(oe=x(n))&&(be.d(1),be=oe(n),be&&(be.c(),be.m(j,L))),F[0]&524288&&G!==(G="flex items-center gap-1 text-xs "+((Te=n[64].assets)!=null&&Te.hasNfo?"text-green-500":"text-red-500"))&&r(j,"class",G),F[0]&524304&&ke!==(ke="border-b border-border hover:bg-accent/50 cursor-pointer "+(n[4].has(n[64].path)?"bg-accent/30 border-l-2 border-l-primary":""))&&r(e,"class",ke)},d(ae){ae&&o(e),ue.d(),S.d(),_.d(),be.d(),me=!1,et(ve)}}}function Ut(n){let e,t,s,a,i,c,m,k=n[14]?"处理中...":"自动刮削",Y,C,W,q,D,g,N,U,I,R,H,B=n[16].total>0&&zt(n);function T(w,V){return w[15]?vs:_s}let M=T(n),p=M(n);return{c(){e=d("div"),B&&B.c(),t=E(),s=d("div"),a=d("div"),p.c(),i=E(),c=d("div"),m=d("button"),Y=X(k),C=E(),W=d("button"),q=X("刷新元数据"),D=E(),g=d("button"),N=X("重新匹配"),this.h()},l(w){e=u(w,"DIV",{class:!0});var V=f(e);B&&B.l(V),t=y(V),s=u(V,"DIV",{class:!0});var b=f(s);a=u(b,"DIV",{class:!0});var j=f(a);p.l(j),j.forEach(o),i=y(b),c=u(b,"DIV",{class:!0});var L=f(c);m=u(L,"BUTTON",{class:!0});var G=f(m);Y=J(G,k),G.forEach(o),C=y(L),W=u(L,"BUTTON",{class:!0});var z=f(W);q=J(z,"刷新元数据"),z.forEach(o),D=y(L),g=u(L,"BUTTON",{class:!0});var O=f(g);N=J(O,"重新匹配"),O.forEach(o),L.forEach(o),b.forEach(o),V.forEach(o),this.h()},h(){r(a,"class","flex items-center gap-4"),r(m,"class","inline-flex items-center justify-center rounded-md text-sm font-medium h-9 px-4 py-2 bg-primary text-primary-foreground hover:opacity-90 disabled:opacity-50"),m.disabled=n[14],r(W,"class","inline-flex items-center justify-center rounded-md text-sm font-medium h-9 px-4 py-2 bg-secondary text-secondary-foreground hover:opacity-90 disabled:opacity-50"),W.disabled=n[14],r(g,"class","inline-flex items-center justify-center rounded-md text-sm font-medium h-9 px-4 py-2 bg-secondary text-secondary-foreground hover:opacity-90 disabled:opacity-50"),g.disabled=n[14],r(c,"class","flex gap-2"),r(s,"class","container mx-auto flex items-center justify-between p-4"),r(e,"class","fixed bottom-0 left-0 right-0 border-t border-border bg-card shadow-lg z-40")},m(w,V){se(w,e,V),B&&B.m(e,null),l(e,t),l(e,s),l(s,a),p.m(a,null),l(s,i),l(s,c),l(c,m),l(m,Y),l(c,C),l(c,W),l(W,q),l(c,D),l(c,g),l(g,N),I=!0,R||(H=[pe(m,"click",n[28]),pe(W,"click",n[29]),pe(g,"click",n[31])],R=!0)},p(w,V){w[16].total>0?B?B.p(w,V):(B=zt(w),B.c(),B.m(e,t)):B&&(B.d(1),B=null),M===(M=T(w))&&p?p.p(w,V):(p.d(1),p=M(w),p&&(p.c(),p.m(a,null))),(!I||V[0]&16384)&&k!==(k=w[14]?"处理中...":"自动刮削")&&Ee(Y,k),(!I||V[0]&16384)&&(m.disabled=w[14]),(!I||V[0]&16384)&&(W.disabled=w[14]),(!I||V[0]&16384)&&(g.disabled=w[14])},i(w){I||(w&&Ye(()=>{I&&(U||(U=Le(e,bt,{y:100,duration:250,easing:Ge},!0)),U.run(1))}),I=!0)},o(w){w&&(U||(U=Le(e,bt,{y:100,duration:250,easing:Ge},!1)),U.run(0)),I=!1},d(w){w&&o(e),B&&B.d(),p.d(),w&&U&&U.end(),R=!1,et(H)}}}function zt(n){let e,t;return{c(){e=d("div"),t=d("div"),this.h()},l(s){e=u(s,"DIV",{class:!0});var a=f(e);t=u(a,"DIV",{class:!0,style:!0}),f(t).forEach(o),a.forEach(o),this.h()},h(){r(t,"class","h-full bg-linear-to-r from-primary to-green-500 transition-all duration-300"),jt(t,"width",n[16].current/n[16].total*100+"%"),r(e,"class","h-1 bg-muted")},m(s,a){se(s,e,a),l(e,t)},p(s,a){a[0]&65536&&jt(t,"width",s[16].current/s[16].total*100+"%")},d(s){s&&o(e)}}}function _s(n){let e,t,s=n[4].size+"",a,i;return{c(){e=d("span"),t=X("已选择 "),a=X(s),i=X(" 部电影"),this.h()},l(c){e=u(c,"SPAN",{class:!0});var m=f(e);t=J(m,"已选择 "),a=J(m,s),i=J(m," 部电影"),m.forEach(o),this.h()},h(){r(e,"class","text-sm text-muted-foreground")},m(c,m){se(c,e,m),l(e,t),l(e,a),l(e,i)},p(c,m){m[0]&16&&s!==(s=c[4].size+"")&&Ee(a,s)},d(c){c&&o(e)}}}function vs(n){let e,t;return{c(){e=d("span"),t=X(n[15]),this.h()},l(s){e=u(s,"SPAN",{class:!0});var a=f(e);t=J(a,n[15]),a.forEach(o),this.h()},h(){r(e,"class","text-sm font-medium")},m(s,a){se(s,e,a),l(e,t)},p(s,a){a[0]&32768&&Ee(t,s[15])},d(s){s&&o(e)}}}function St(n){let e,t,s,a,i,c,m,k="电影详情",Y,C,W='<svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg>',q,D,g,N,U=n[6].name+"",I,R,H,B=(n[6].year||"未知年份")+"",T,M,p,w,V,b="TMDB ID",j,L,G=n[6].tmdbId?`#${n[6].tmdbId}`:"未匹配",z,O,P,v,A="状态",Q,ce,de=n[6].isProcessed?"已刮削":"未刮削",ge,ke,me,ve,De="路径",_e,Ce,ue=n[6].path+"",we,$,S,ne,ie="完整性",_,x,oe,be,Pe,Me,xe,Be,ae,F,ee,Te,Ue="操作",h,Z,K,fe=n[14]?"处理中...":"刷新元数据",Ie,je,Ae,Ke="重新匹配",ze,Oe,Ne,kt,Et;function Ct(te,ye){var He;return(He=te[6].assets)!=null&&He.hasPoster?gs:bs}let st=Ct(n),qe=st(n);function Tt(te,ye){var He;return(He=te[6].assets)!=null&&He.hasNfo?ws:ks}let rt=Tt(n),Re=rt(n),Ve=n[15]&&Ft(n);return{c(){e=d("div"),t=d("button"),a=E(),i=d("div"),c=d("div"),m=d("h2"),m.textContent=k,Y=E(),C=d("button"),C.innerHTML=W,q=E(),D=d("div"),g=d("div"),N=d("h3"),I=X(U),R=E(),H=d("p"),T=X(B),M=E(),p=d("div"),w=d("div"),V=d("p"),V.textContent=b,j=E(),L=d("p"),z=X(G),O=E(),P=d("div"),v=d("p"),v.textContent=A,Q=E(),ce=d("p"),ge=X(de),ke=E(),me=d("div"),ve=d("p"),ve.textContent=De,_e=E(),Ce=d("p"),we=X(ue),$=E(),S=d("div"),ne=d("p"),ne.textContent=ie,_=E(),x=d("div"),oe=d("span"),qe.c(),be=X(`
              海报`),Me=E(),xe=d("span"),Re.c(),Be=X(`
              NFO`),F=E(),ee=d("div"),Te=d("p"),Te.textContent=Ue,h=E(),Z=d("div"),K=d("button"),Ie=X(fe),je=E(),Ae=d("button"),Ae.textContent=Ke,ze=E(),Ve&&Ve.c(),this.h()},l(te){e=u(te,"DIV",{class:!0});var ye=f(e);t=u(ye,"BUTTON",{class:!0}),f(t).forEach(o),a=y(ye),i=u(ye,"DIV",{class:!0});var He=f(i);c=u(He,"DIV",{class:!0});var Qe=f(c);m=u(Qe,"H2",{class:!0,"data-svelte-h":!0}),he(m)!=="svelte-1n6w7z8"&&(m.textContent=k),Y=y(Qe),C=u(Qe,"BUTTON",{class:!0,"data-svelte-h":!0}),he(C)!=="svelte-2nps8z"&&(C.innerHTML=W),Qe.forEach(o),q=y(He),D=u(He,"DIV",{class:!0});var Fe=f(D);g=u(Fe,"DIV",{});var lt=f(g);N=u(lt,"H3",{class:!0});var Dt=f(N);I=J(Dt,U),Dt.forEach(o),R=y(lt),H=u(lt,"P",{class:!0});var Bt=f(H);T=J(Bt,B),Bt.forEach(o),lt.forEach(o),M=y(Fe),p=u(Fe,"DIV",{class:!0});var nt=f(p);w=u(nt,"DIV",{});var at=f(w);V=u(at,"P",{class:!0,"data-svelte-h":!0}),he(V)!=="svelte-1k1hw98"&&(V.textContent=b),j=y(at),L=u(at,"P",{class:!0});var It=f(L);z=J(It,G),It.forEach(o),at.forEach(o),O=y(nt),P=u(nt,"DIV",{});var ot=f(P);v=u(ot,"P",{class:!0,"data-svelte-h":!0}),he(v)!=="svelte-jzx24d"&&(v.textContent=A),Q=y(ot),ce=u(ot,"P",{class:!0});var Mt=f(ce);ge=J(Mt,de),Mt.forEach(o),ot.forEach(o),nt.forEach(o),ke=y(Fe),me=u(Fe,"DIV",{});var it=f(me);ve=u(it,"P",{class:!0,"data-svelte-h":!0}),he(ve)!=="svelte-6oqzvz"&&(ve.textContent=De),_e=y(it),Ce=u(it,"P",{class:!0});var Pt=f(Ce);we=J(Pt,ue),Pt.forEach(o),it.forEach(o),$=y(Fe),S=u(Fe,"DIV",{});var ct=f(S);ne=u(ct,"P",{class:!0,"data-svelte-h":!0}),he(ne)!=="svelte-10jdl1z"&&(ne.textContent=ie),_=y(ct),x=u(ct,"DIV",{class:!0});var ut=f(x);oe=u(ut,"SPAN",{class:!0});var wt=f(oe);qe.l(wt),be=J(wt,`
              海报`),wt.forEach(o),Me=y(ut),xe=u(ut,"SPAN",{class:!0});var xt=f(xe);Re.l(xt),Be=J(xt,`
              NFO`),xt.forEach(o),ut.forEach(o),ct.forEach(o),F=y(Fe),ee=u(Fe,"DIV",{class:!0});var Ze=f(ee);Te=u(Ze,"P",{class:!0,"data-svelte-h":!0}),he(Te)!=="svelte-5tqjb3"&&(Te.textContent=Ue),h=y(Ze),Z=u(Ze,"DIV",{class:!0});var dt=f(Z);K=u(dt,"BUTTON",{class:!0});var Vt=f(K);Ie=J(Vt,fe),Vt.forEach(o),je=y(dt),Ae=u(dt,"BUTTON",{class:!0,"data-svelte-h":!0}),he(Ae)!=="svelte-1f1t1vy"&&(Ae.textContent=Ke),dt.forEach(o),ze=y(Ze),Ve&&Ve.l(Ze),Ze.forEach(o),Fe.forEach(o),He.forEach(o),ye.forEach(o),this.h()},h(){var te,ye;r(t,"class","absolute inset-0 bg-black/50"),r(m,"class","text-lg font-semibold"),r(C,"class","inline-flex items-center justify-center rounded-md h-8 w-8 hover:bg-accent"),r(c,"class","sticky top-0 flex items-center justify-between border-b border-border bg-card p-4"),r(N,"class","text-xl font-bold mb-2"),r(H,"class","text-muted-foreground"),r(V,"class","text-muted-foreground"),r(L,"class","font-medium"),r(v,"class","text-muted-foreground"),r(ce,"class","font-medium"),r(p,"class","grid grid-cols-2 gap-4 text-sm"),r(ve,"class","text-sm text-muted-foreground mb-2"),r(Ce,"class","font-mono text-xs bg-muted p-2 rounded"),r(ne,"class","text-sm text-muted-foreground mb-2"),r(oe,"class",Pe="flex items-center gap-1 text-sm "+((te=n[6].assets)!=null&&te.hasPoster?"text-green-500":"text-red-500")),r(xe,"class",ae="flex items-center gap-1 text-sm "+((ye=n[6].assets)!=null&&ye.hasNfo?"text-green-500":"text-red-500")),r(x,"class","flex gap-4"),r(Te,"class","text-sm text-muted-foreground"),r(K,"class","inline-flex items-center justify-center rounded-md text-sm font-medium h-9 px-4 py-2 bg-primary text-primary-foreground hover:opacity-90 disabled:opacity-50"),K.disabled=n[14],r(Ae,"class","inline-flex items-center justify-center rounded-md text-sm font-medium h-9 px-4 py-2 bg-secondary text-secondary-foreground hover:opacity-90"),r(Z,"class","flex flex-wrap gap-2"),r(ee,"class","space-y-2"),r(D,"class","p-4 space-y-6"),r(i,"class","absolute right-0 top-0 bottom-0 w-full max-w-lg bg-card border-l border-border overflow-y-auto"),r(e,"class","fixed inset-0 z-50")},m(te,ye){se(te,e,ye),l(e,t),l(e,a),l(e,i),l(i,c),l(c,m),l(c,Y),l(c,C),l(i,q),l(i,D),l(D,g),l(g,N),l(N,I),l(g,R),l(g,H),l(H,T),l(D,M),l(D,p),l(p,w),l(w,V),l(w,j),l(w,L),l(L,z),l(p,O),l(p,P),l(P,v),l(P,Q),l(P,ce),l(ce,ge),l(D,ke),l(D,me),l(me,ve),l(me,_e),l(me,Ce),l(Ce,we),l(D,$),l(D,S),l(S,ne),l(S,_),l(S,x),l(x,oe),qe.m(oe,null),l(oe,be),l(x,Me),l(x,xe),Re.m(xe,null),l(xe,Be),l(D,F),l(D,ee),l(ee,Te),l(ee,h),l(ee,Z),l(Z,K),l(K,Ie),l(Z,je),l(Z,Ae),l(ee,ze),Ve&&Ve.m(ee,null),Ne=!0,kt||(Et=[pe(t,"click",n[23]),pe(C,"click",n[23]),pe(K,"click",n[42]),pe(Ae,"click",n[43])],kt=!0)},p(te,ye){var He,Qe;(!Ne||ye[0]&64)&&U!==(U=te[6].name+"")&&Ee(I,U),(!Ne||ye[0]&64)&&B!==(B=(te[6].year||"未知年份")+"")&&Ee(T,B),(!Ne||ye[0]&64)&&G!==(G=te[6].tmdbId?`#${te[6].tmdbId}`:"未匹配")&&Ee(z,G),(!Ne||ye[0]&64)&&de!==(de=te[6].isProcessed?"已刮削":"未刮削")&&Ee(ge,de),(!Ne||ye[0]&64)&&ue!==(ue=te[6].path+"")&&Ee(we,ue),st!==(st=Ct(te))&&(qe.d(1),qe=st(te),qe&&(qe.c(),qe.m(oe,be))),(!Ne||ye[0]&64&&Pe!==(Pe="flex items-center gap-1 text-sm "+((He=te[6].assets)!=null&&He.hasPoster?"text-green-500":"text-red-500")))&&r(oe,"class",Pe),rt!==(rt=Tt(te))&&(Re.d(1),Re=rt(te),Re&&(Re.c(),Re.m(xe,Be))),(!Ne||ye[0]&64&&ae!==(ae="flex items-center gap-1 text-sm "+((Qe=te[6].assets)!=null&&Qe.hasNfo?"text-green-500":"text-red-500")))&&r(xe,"class",ae),(!Ne||ye[0]&16384)&&fe!==(fe=te[14]?"处理中...":"刷新元数据")&&Ee(Ie,fe),(!Ne||ye[0]&16384)&&(K.disabled=te[14]),te[15]?Ve?Ve.p(te,ye):(Ve=Ft(te),Ve.c(),Ve.m(ee,null)):Ve&&(Ve.d(1),Ve=null)},i(te){Ne||(te&&Ye(()=>{Ne&&(s||(s=Le(t,$e,{duration:200},!0)),s.run(1))}),te&&Ye(()=>{Ne&&(Oe||(Oe=Le(i,bt,{x:400,duration:300,easing:Ge},!0)),Oe.run(1))}),Ne=!0)},o(te){te&&(s||(s=Le(t,$e,{duration:200},!1)),s.run(0)),te&&(Oe||(Oe=Le(i,bt,{x:400,duration:300,easing:Ge},!1)),Oe.run(0)),Ne=!1},d(te){te&&o(e),te&&s&&s.end(),qe.d(),Re.d(),Ve&&Ve.d(),te&&Oe&&Oe.end(),kt=!1,et(Et)}}}function bs(n){let e,t,s,a;return{c(){e=le("svg"),t=le("circle"),s=le("path"),a=le("path"),this.h()},l(i){e=re(i,"svg",{class:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var c=f(e);t=re(c,"circle",{cx:!0,cy:!0,r:!0}),f(t).forEach(o),s=re(c,"path",{d:!0}),f(s).forEach(o),a=re(c,"path",{d:!0}),f(a).forEach(o),c.forEach(o),this.h()},h(){r(t,"cx","12"),r(t,"cy","12"),r(t,"r","10"),r(s,"d","m15 9-6 6"),r(a,"d","m9 9 6 6"),r(e,"class","h-4 w-4"),r(e,"viewBox","0 0 24 24"),r(e,"fill","none"),r(e,"stroke","currentColor"),r(e,"stroke-width","2")},m(i,c){se(i,e,c),l(e,t),l(e,s),l(e,a)},d(i){i&&o(e)}}}function gs(n){let e,t,s;return{c(){e=le("svg"),t=le("path"),s=le("path"),this.h()},l(a){e=re(a,"svg",{class:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var i=f(e);t=re(i,"path",{d:!0}),f(t).forEach(o),s=re(i,"path",{d:!0}),f(s).forEach(o),i.forEach(o),this.h()},h(){r(t,"d","M22 11.08V12a10 10 0 1 1-5.93-9.14"),r(s,"d","m9 11 3 3L22 4"),r(e,"class","h-4 w-4"),r(e,"viewBox","0 0 24 24"),r(e,"fill","none"),r(e,"stroke","currentColor"),r(e,"stroke-width","2")},m(a,i){se(a,e,i),l(e,t),l(e,s)},d(a){a&&o(e)}}}function ks(n){let e,t,s,a;return{c(){e=le("svg"),t=le("circle"),s=le("path"),a=le("path"),this.h()},l(i){e=re(i,"svg",{class:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var c=f(e);t=re(c,"circle",{cx:!0,cy:!0,r:!0}),f(t).forEach(o),s=re(c,"path",{d:!0}),f(s).forEach(o),a=re(c,"path",{d:!0}),f(a).forEach(o),c.forEach(o),this.h()},h(){r(t,"cx","12"),r(t,"cy","12"),r(t,"r","10"),r(s,"d","m15 9-6 6"),r(a,"d","m9 9 6 6"),r(e,"class","h-4 w-4"),r(e,"viewBox","0 0 24 24"),r(e,"fill","none"),r(e,"stroke","currentColor"),r(e,"stroke-width","2")},m(i,c){se(i,e,c),l(e,t),l(e,s),l(e,a)},d(i){i&&o(e)}}}function ws(n){let e,t,s;return{c(){e=le("svg"),t=le("path"),s=le("path"),this.h()},l(a){e=re(a,"svg",{class:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var i=f(e);t=re(i,"path",{d:!0}),f(t).forEach(o),s=re(i,"path",{d:!0}),f(s).forEach(o),i.forEach(o),this.h()},h(){r(t,"d","M22 11.08V12a10 10 0 1 1-5.93-9.14"),r(s,"d","m9 11 3 3L22 4"),r(e,"class","h-4 w-4"),r(e,"viewBox","0 0 24 24"),r(e,"fill","none"),r(e,"stroke","currentColor"),r(e,"stroke-width","2")},m(a,i){se(a,e,i),l(e,t),l(e,s)},d(a){a&&o(e)}}}function Ft(n){let e,t;return{c(){e=d("p"),t=X(n[15]),this.h()},l(s){e=u(s,"P",{class:!0});var a=f(e);t=J(a,n[15]),a.forEach(o),this.h()},h(){r(e,"class","text-sm text-muted-foreground")},m(s,a){se(s,e,a),l(e,t)},p(s,a){a[0]&32768&&Ee(t,s[15])},d(s){s&&o(e)}}}function qt(n){let e,t,s,a,i,c,m,k="TMDB 搜索",Y,C,W='<svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg>',q,D,g,N,U,I,R=n[10]?"搜索中...":"搜索",H,B,T,M,p,w,V="取消",b,j,L,G;function z(v,A){if(v[9].length>0)return ys;if(!v[10])return xs}let O=z(n),P=O&&O(n);return{c(){e=d("div"),t=d("button"),a=E(),i=d("div"),c=d("div"),m=d("h2"),m.textContent=k,Y=E(),C=d("button"),C.innerHTML=W,q=E(),D=d("div"),g=d("div"),N=d("input"),U=E(),I=d("button"),H=X(R),B=E(),T=d("div"),P&&P.c(),M=E(),p=d("div"),w=d("button"),w.textContent=V,this.h()},l(v){e=u(v,"DIV",{class:!0});var A=f(e);t=u(A,"BUTTON",{class:!0}),f(t).forEach(o),a=y(A),i=u(A,"DIV",{class:!0});var Q=f(i);c=u(Q,"DIV",{class:!0});var ce=f(c);m=u(ce,"H2",{class:!0,"data-svelte-h":!0}),he(m)!=="svelte-1dq97nw"&&(m.textContent=k),Y=y(ce),C=u(ce,"BUTTON",{class:!0,"data-svelte-h":!0}),he(C)!=="svelte-tcsr7s"&&(C.innerHTML=W),ce.forEach(o),q=y(Q),D=u(Q,"DIV",{class:!0});var de=f(D);g=u(de,"DIV",{class:!0});var ge=f(g);N=u(ge,"INPUT",{type:!0,class:!0,placeholder:!0}),U=y(ge),I=u(ge,"BUTTON",{class:!0});var ke=f(I);H=J(ke,R),ke.forEach(o),ge.forEach(o),B=y(de),T=u(de,"DIV",{class:!0});var me=f(T);P&&P.l(me),me.forEach(o),de.forEach(o),M=y(Q),p=u(Q,"DIV",{class:!0});var ve=f(p);w=u(ve,"BUTTON",{class:!0,"data-svelte-h":!0}),he(w)!=="svelte-k2omh7"&&(w.textContent=V),ve.forEach(o),Q.forEach(o),A.forEach(o),this.h()},h(){r(t,"class","absolute inset-0 bg-black/50"),r(m,"class","text-lg font-semibold"),r(C,"class","inline-flex items-center justify-center rounded-md h-8 w-8 hover:bg-accent"),r(c,"class","flex items-center justify-between border-b border-border p-4"),r(N,"type","text"),r(N,"class","flex-1 h-10 rounded-md border border-input bg-background px-3 text-sm"),r(N,"placeholder","输入搜索关键词..."),r(I,"class","inline-flex items-center justify-center rounded-md text-sm font-medium h-10 px-4 py-2 bg-primary text-primary-foreground hover:opacity-90 disabled:opacity-50"),I.disabled=n[10],r(g,"class","flex gap-2"),r(T,"class","max-h-80 overflow-y-auto space-y-2"),r(D,"class","p-4 space-y-4"),r(w,"class","inline-flex items-center justify-center rounded-md text-sm font-medium h-9 px-4 py-2 border border-input bg-background hover:bg-accent"),r(p,"class","flex justify-end gap-2 border-t border-border p-4"),r(i,"class","relative w-full max-w-xl bg-card border border-border rounded-lg shadow-lg overflow-hidden"),r(e,"class","fixed inset-0 z-50 flex items-center justify-center")},m(v,A){se(v,e,A),l(e,t),l(e,a),l(e,i),l(i,c),l(c,m),l(c,Y),l(c,C),l(i,q),l(i,D),l(D,g),l(g,N),Xe(N,n[8]),l(g,U),l(g,I),l(I,H),l(D,B),l(D,T),P&&P.m(T,null),l(i,M),l(i,p),l(p,w),j=!0,L||(G=[pe(t,"click",n[26]),pe(C,"click",n[26]),pe(N,"input",n[44]),pe(N,"keydown",n[45]),pe(I,"click",n[24]),pe(w,"click",n[26])],L=!0)},p(v,A){A[0]&256&&N.value!==v[8]&&Xe(N,v[8]),(!j||A[0]&1024)&&R!==(R=v[10]?"搜索中...":"搜索")&&Ee(H,R),(!j||A[0]&1024)&&(I.disabled=v[10]),O===(O=z(v))&&P?P.p(v,A):(P&&P.d(1),P=O&&O(v),P&&(P.c(),P.m(T,null)))},i(v){j||(v&&Ye(()=>{j&&(s||(s=Le(t,$e,{duration:200},!0)),s.run(1))}),v&&Ye(()=>{j&&(b||(b=Le(i,gt,{duration:200,start:.95,easing:Ge},!0)),b.run(1))}),j=!0)},o(v){v&&(s||(s=Le(t,$e,{duration:200},!1)),s.run(0)),v&&(b||(b=Le(i,gt,{duration:200,start:.95,easing:Ge},!1)),b.run(0)),j=!1},d(v){v&&o(e),v&&s&&s.end(),P&&P.d(),v&&b&&b.end(),L=!1,et(G)}}}function xs(n){let e,t="输入关键词搜索 TMDB";return{c(){e=d("p"),e.textContent=t,this.h()},l(s){e=u(s,"P",{class:!0,"data-svelte-h":!0}),he(e)!=="svelte-1kihksy"&&(e.textContent=t),this.h()},h(){r(e,"class","text-center text-muted-foreground py-8")},m(s,a){se(s,e,a)},p:tt,d(s){s&&o(e)}}}function ys(n){let e,t=vt(n[9]),s=[];for(let a=0;a<t.length;a+=1)s[a]=Rt(At(n,t,a));return{c(){for(let a=0;a<s.length;a+=1)s[a].c();e=_t()},l(a){for(let i=0;i<s.length;i+=1)s[i].l(a);e=_t()},m(a,i){for(let c=0;c<s.length;c+=1)s[c]&&s[c].m(a,i);se(a,e,i)},p(a,i){if(i[0]&134218240){t=vt(a[9]);let c;for(c=0;c<t.length;c+=1){const m=At(a,t,c);s[c]?s[c].p(m,i):(s[c]=Rt(m),s[c].c(),s[c].m(e.parentNode,e))}for(;c<s.length;c+=1)s[c].d(1);s.length=t.length}},d(a){a&&o(e),Gt(s,a)}}}function Es(n){let e,t='<svg class="h-5 w-5 text-muted-foreground" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect width="18" height="18" x="3" y="3" rx="2"></rect></svg>';return{c(){e=d("div"),e.innerHTML=t,this.h()},l(s){e=u(s,"DIV",{class:!0,"data-svelte-h":!0}),he(e)!=="svelte-1n0hfbl"&&(e.innerHTML=t),this.h()},h(){r(e,"class","w-10 h-14 bg-muted rounded flex items-center justify-center shrink-0")},m(s,a){se(s,e,a)},p:tt,d(s){s&&o(e)}}}function Cs(n){let e,t,s;return{c(){e=d("img"),this.h()},l(a){e=u(a,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){mt(e.src,t=n[61].posterPath)||r(e,"src",t),r(e,"alt",s=n[61].title||n[61].name),r(e,"class","w-10 h-14 object-cover rounded shrink-0")},m(a,i){se(a,e,i)},p(a,i){i[0]&512&&!mt(e.src,t=a[61].posterPath)&&r(e,"src",t),i[0]&512&&s!==(s=a[61].title||a[61].name)&&r(e,"alt",s)},d(a){a&&o(e)}}}function Rt(n){var p,w;let e,t,s,a,i=(n[61].title||n[61].name)+"",c,m,k,Y=(((p=n[61].releaseDate)==null?void 0:p.slice(0,4))||((w=n[61].firstAirDate)==null?void 0:w.slice(0,4))||"未知")+"",C,W,q,D,g=n[61].id+"",N,U,I,R;function H(V,b){return V[61].posterPath?Cs:Es}let B=H(n),T=B(n);function M(){return n[46](n[61])}return{c(){e=d("button"),T.c(),t=E(),s=d("div"),a=d("p"),c=X(i),m=E(),k=d("p"),C=X(Y),W=E(),q=d("span"),D=X("TMDB#"),N=X(g),U=E(),this.h()},l(V){e=u(V,"BUTTON",{class:!0});var b=f(e);T.l(b),t=y(b),s=u(b,"DIV",{class:!0});var j=f(s);a=u(j,"P",{class:!0});var L=f(a);c=J(L,i),L.forEach(o),m=y(j),k=u(j,"P",{class:!0});var G=f(k);C=J(G,Y),G.forEach(o),j.forEach(o),W=y(b),q=u(b,"SPAN",{class:!0});var z=f(q);D=J(z,"TMDB#"),N=J(z,g),z.forEach(o),U=y(b),b.forEach(o),this.h()},h(){r(a,"class","font-medium truncate"),r(k,"class","text-sm text-muted-foreground"),r(s,"class","flex-1 min-w-0"),r(q,"class","text-xs text-muted-foreground"),r(e,"class","w-full flex items-center gap-4 p-3 rounded-md border border-border hover:bg-accent/50 text-left")},m(V,b){se(V,e,b),T.m(e,null),l(e,t),l(e,s),l(s,a),l(a,c),l(s,m),l(s,k),l(k,C),l(e,W),l(e,q),l(q,D),l(q,N),l(e,U),I||(R=pe(e,"click",M),I=!0)},p(V,b){var j,L;n=V,B===(B=H(n))&&T?T.p(n,b):(T.d(1),T=B(n),T&&(T.c(),T.m(e,t))),b[0]&512&&i!==(i=(n[61].title||n[61].name)+"")&&Ee(c,i),b[0]&512&&Y!==(Y=(((j=n[61].releaseDate)==null?void 0:j.slice(0,4))||((L=n[61].firstAirDate)==null?void 0:L.slice(0,4))||"未知")+"")&&Ee(C,Y),b[0]&512&&g!==(g=n[61].id+"")&&Ee(N,g)},d(V){V&&o(e),T.d(),I=!1,R()}}}function Kt(n){let e,t,s,a,i,c,m,k="一键刮削",Y,C,W='<svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg>',q,D,g,N,U=n[13].length+"",I,R,H=n[13].filter(Wt).length+"",B,T,M,p,w,V="选择消歧方式：",b,j,L,G,z,O='<p class="font-medium">手动匹配</p> <p class="text-sm text-muted-foreground">逐个确认 TMDB 匹配结果，适合对准确性要求高的场景</p>',P,v,A,Q,ce,de,ge='<p class="font-medium flex items-center gap-2">AI 自动 <svg class="h-4 w-4 text-yellow-500" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2L15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2Z"></path></svg></p> <p class="text-sm text-muted-foreground">使用 AI 自动选择最佳匹配，适合批量快速处理</p>',ke,me,ve,De,_e="取消",Ce,ue,we="开始刮削",$,S,ne,ie,_;return ne=$t(n[50][0]),{c(){e=d("div"),t=d("button"),a=E(),i=d("div"),c=d("div"),m=d("h2"),m.textContent=k,Y=E(),C=d("button"),C.innerHTML=W,q=E(),D=d("div"),g=d("p"),N=X("选中 "),I=X(U),R=X(" 部电影，其中 "),B=X(H),T=X(" 部需要匹配 TMDB。"),M=E(),p=d("div"),w=d("p"),w.textContent=V,b=E(),j=d("label"),L=d("input"),G=E(),z=d("div"),z.innerHTML=O,v=E(),A=d("label"),Q=d("input"),ce=E(),de=d("div"),de.innerHTML=ge,me=E(),ve=d("div"),De=d("button"),De.textContent=_e,Ce=E(),ue=d("button"),ue.textContent=we,this.h()},l(x){e=u(x,"DIV",{class:!0});var oe=f(e);t=u(oe,"BUTTON",{class:!0}),f(t).forEach(o),a=y(oe),i=u(oe,"DIV",{class:!0});var be=f(i);c=u(be,"DIV",{class:!0});var Pe=f(c);m=u(Pe,"H2",{class:!0,"data-svelte-h":!0}),he(m)!=="svelte-cuhqyl"&&(m.textContent=k),Y=y(Pe),C=u(Pe,"BUTTON",{class:!0,"data-svelte-h":!0}),he(C)!=="svelte-amyx0j"&&(C.innerHTML=W),Pe.forEach(o),q=y(be),D=u(be,"DIV",{class:!0});var Me=f(D);g=u(Me,"P",{class:!0});var xe=f(g);N=J(xe,"选中 "),I=J(xe,U),R=J(xe," 部电影，其中 "),B=J(xe,H),T=J(xe," 部需要匹配 TMDB。"),xe.forEach(o),M=y(Me),p=u(Me,"DIV",{class:!0});var Be=f(p);w=u(Be,"P",{class:!0,"data-svelte-h":!0}),he(w)!=="svelte-1g6y89l"&&(w.textContent=V),b=y(Be),j=u(Be,"LABEL",{class:!0});var ae=f(j);L=u(ae,"INPUT",{type:!0,class:!0}),G=y(ae),z=u(ae,"DIV",{"data-svelte-h":!0}),he(z)!=="svelte-1ng0myv"&&(z.innerHTML=O),ae.forEach(o),v=y(Be),A=u(Be,"LABEL",{class:!0});var F=f(A);Q=u(F,"INPUT",{type:!0,class:!0}),ce=y(F),de=u(F,"DIV",{"data-svelte-h":!0}),he(de)!=="svelte-1onmt3y"&&(de.innerHTML=ge),F.forEach(o),Be.forEach(o),Me.forEach(o),me=y(be),ve=u(be,"DIV",{class:!0});var ee=f(ve);De=u(ee,"BUTTON",{class:!0,"data-svelte-h":!0}),he(De)!=="svelte-1kn8oou"&&(De.textContent=_e),Ce=y(ee),ue=u(ee,"BUTTON",{class:!0,"data-svelte-h":!0}),he(ue)!=="svelte-aue2u5"&&(ue.textContent=we),ee.forEach(o),be.forEach(o),oe.forEach(o),this.h()},h(){r(t,"class","absolute inset-0 bg-black/50"),r(m,"class","text-lg font-semibold"),r(C,"class","inline-flex items-center justify-center rounded-md h-8 w-8 hover:bg-accent"),r(c,"class","flex items-center justify-between border-b border-border p-4"),r(g,"class","text-sm text-muted-foreground"),r(w,"class","text-sm font-medium"),r(L,"type","radio"),L.__value="manual",Xe(L,L.__value),r(L,"class","mt-0.5"),r(j,"class",P="flex items-start gap-3 p-3 rounded-md border border-border hover:bg-accent/50 cursor-pointer "+(n[12]==="manual"?"border-primary bg-accent/30":"")),r(Q,"type","radio"),Q.__value="ai",Xe(Q,Q.__value),r(Q,"class","mt-0.5"),r(A,"class",ke="flex items-start gap-3 p-3 rounded-md border border-border hover:bg-accent/50 cursor-pointer "+(n[12]==="ai"?"border-primary bg-accent/30":"")),r(p,"class","space-y-2"),r(D,"class","p-4 space-y-4"),r(De,"class","inline-flex items-center justify-center rounded-md text-sm font-medium h-9 px-4 py-2 border border-input bg-background hover:bg-accent"),r(ue,"class","inline-flex items-center justify-center rounded-md text-sm font-medium h-9 px-4 py-2 bg-primary text-primary-foreground hover:opacity-90"),r(ve,"class","flex justify-end gap-2 border-t border-border p-4"),r(i,"class","relative w-full max-w-md bg-card border border-border rounded-lg shadow-lg overflow-hidden"),r(e,"class","fixed inset-0 z-50 flex items-center justify-center"),ne.p(L,Q)},m(x,oe){se(x,e,oe),l(e,t),l(e,a),l(e,i),l(i,c),l(c,m),l(c,Y),l(c,C),l(i,q),l(i,D),l(D,g),l(g,N),l(g,I),l(g,R),l(g,B),l(g,T),l(D,M),l(D,p),l(p,w),l(p,b),l(p,j),l(j,L),L.checked=L.__value===n[12],l(j,G),l(j,z),l(p,v),l(p,A),l(A,Q),Q.checked=Q.__value===n[12],l(A,ce),l(A,de),l(i,me),l(i,ve),l(ve,De),l(ve,Ce),l(ve,ue),S=!0,ie||(_=[pe(t,"click",n[47]),pe(C,"click",n[48]),pe(L,"change",n[49]),pe(Q,"change",n[51]),pe(De,"click",n[52]),pe(ue,"click",n[30])],ie=!0)},p(x,oe){(!S||oe[0]&8192)&&U!==(U=x[13].length+"")&&Ee(I,U),(!S||oe[0]&8192)&&H!==(H=x[13].filter(Wt).length+"")&&Ee(B,H),oe[0]&4096&&(L.checked=L.__value===x[12]),(!S||oe[0]&4096&&P!==(P="flex items-start gap-3 p-3 rounded-md border border-border hover:bg-accent/50 cursor-pointer "+(x[12]==="manual"?"border-primary bg-accent/30":"")))&&r(j,"class",P),oe[0]&4096&&(Q.checked=Q.__value===x[12]),(!S||oe[0]&4096&&ke!==(ke="flex items-start gap-3 p-3 rounded-md border border-border hover:bg-accent/50 cursor-pointer "+(x[12]==="ai"?"border-primary bg-accent/30":"")))&&r(A,"class",ke)},i(x){S||(x&&Ye(()=>{S&&(s||(s=Le(t,$e,{duration:200},!0)),s.run(1))}),x&&Ye(()=>{S&&($||($=Le(i,gt,{duration:200,start:.95,easing:Ge},!0)),$.run(1))}),S=!0)},o(x){x&&(s||(s=Le(t,$e,{duration:200},!1)),s.run(0)),x&&($||($=Le(i,gt,{duration:200,start:.95,easing:Ge},!1)),$.run(0)),S=!1},d(x){x&&o(e),x&&s&&s.end(),x&&$&&$.end(),ne.r(),ie=!1,et(_)}}}function Ts(n){let e,t,s,a,i,c,m,k,Y,C,W,q,D,g,N,U,I,R=n[0].length+"",H,B,T,M,p,w,V,b,j,L,G,z,O,P,v,A,Q,ce,de,ge,ke,me,ve,De,_e=n[15]&&n[4].size===0&&Ot(n);function Ce(_,x){return _[3]?as:_[19].length===0?ns:ls}let ue=Ce(n),we=ue(n),$=(n[4].size>0||n[14])&&Ut(n),S=n[5]&&n[6]&&St(n),ne=n[7]&&qt(n),ie=n[11]&&Kt(n);return{c(){e=d("main"),t=d("div"),s=d("div"),a=d("div"),i=d("div"),c=le("svg"),m=le("circle"),k=le("path"),Y=E(),C=d("input"),W=E(),q=d("div"),_e&&_e.c(),D=E(),g=d("div"),N=d("div"),U=d("button"),I=X("全部 ("),H=X(R),B=X(")"),M=E(),p=d("button"),w=X("已刮削 ("),V=X(n[18]),b=X(")"),L=E(),G=d("button"),z=X("未刮削 ("),O=X(n[17]),P=X(")"),A=E(),Q=d("div"),we.c(),ce=E(),$&&$.c(),de=E(),S&&S.c(),ge=E(),ne&&ne.c(),ke=E(),ie&&ie.c(),me=_t(),this.h()},l(_){e=u(_,"MAIN",{class:!0});var x=f(e);t=u(x,"DIV",{class:!0});var oe=f(t);s=u(oe,"DIV",{class:!0});var be=f(s);a=u(be,"DIV",{class:!0});var Pe=f(a);i=u(Pe,"DIV",{class:!0});var Me=f(i);c=re(Me,"svg",{class:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var xe=f(c);m=re(xe,"circle",{cx:!0,cy:!0,r:!0}),f(m).forEach(o),k=re(xe,"path",{d:!0}),f(k).forEach(o),xe.forEach(o),Y=y(Me),C=u(Me,"INPUT",{type:!0,placeholder:!0,class:!0}),Me.forEach(o),Pe.forEach(o),W=y(be),q=u(be,"DIV",{class:!0});var Be=f(q);_e&&_e.l(Be),Be.forEach(o),be.forEach(o),D=y(oe),g=u(oe,"DIV",{class:!0});var ae=f(g);N=u(ae,"DIV",{class:!0});var F=f(N);U=u(F,"BUTTON",{class:!0});var ee=f(U);I=J(ee,"全部 ("),H=J(ee,R),B=J(ee,")"),ee.forEach(o),M=y(F),p=u(F,"BUTTON",{class:!0});var Te=f(p);w=J(Te,"已刮削 ("),V=J(Te,n[18]),b=J(Te,")"),Te.forEach(o),L=y(F),G=u(F,"BUTTON",{class:!0});var Ue=f(G);z=J(Ue,"未刮削 ("),O=J(Ue,n[17]),P=J(Ue,")"),Ue.forEach(o),F.forEach(o),ae.forEach(o),oe.forEach(o),A=y(x),Q=u(x,"DIV",{class:!0});var h=f(Q);we.l(h),h.forEach(o),ce=y(x),$&&$.l(x),x.forEach(o),de=y(_),S&&S.l(_),ge=y(_),ne&&ne.l(_),ke=y(_),ie&&ie.l(_),me=_t(),this.h()},h(){r(m,"cx","11"),r(m,"cy","11"),r(m,"r","8"),r(k,"d","m21 21-4.3-4.3"),r(c,"class","absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"),r(c,"viewBox","0 0 24 24"),r(c,"fill","none"),r(c,"stroke","currentColor"),r(c,"stroke-width","2"),r(C,"type","text"),r(C,"placeholder","搜索电影..."),r(C,"class","h-9 w-64 rounded-md border border-input bg-background pl-9 pr-3 text-sm"),r(i,"class","relative"),r(a,"class","flex items-center gap-4 flex-wrap"),r(q,"class","flex gap-2 items-center"),r(s,"class","flex items-center justify-between flex-wrap gap-4"),r(U,"class",T="inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium transition-all "+(n[2]==="all"?"bg-background text-foreground shadow-sm":"")),r(p,"class",j="inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium transition-all "+(n[2]==="scraped"?"bg-background text-foreground shadow-sm":"")),r(G,"class",v="inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium transition-all "+(n[2]==="unscraped"?"bg-background text-foreground shadow-sm":"")),r(N,"class","inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground"),r(g,"class","flex items-center justify-between flex-wrap gap-4"),r(t,"class","mb-6 space-y-4"),r(Q,"class","rounded-lg border border-border bg-card overflow-hidden"),r(e,"class","container mx-auto px-4 py-8"),Nt(e,"pb-24",n[4].size>0||n[14])},m(_,x){se(_,e,x),l(e,t),l(t,s),l(s,a),l(a,i),l(i,c),l(c,m),l(c,k),l(i,Y),l(i,C),Xe(C,n[1]),l(s,W),l(s,q),_e&&_e.m(q,null),l(t,D),l(t,g),l(g,N),l(N,U),l(U,I),l(U,H),l(U,B),l(N,M),l(N,p),l(p,w),l(p,V),l(p,b),l(N,L),l(N,G),l(G,z),l(G,O),l(G,P),l(e,A),l(e,Q),we.m(Q,null),l(e,ce),$&&$.m(e,null),se(_,de,x),S&&S.m(_,x),se(_,ge,x),ne&&ne.m(_,x),se(_,ke,x),ie&&ie.m(_,x),se(_,me,x),ve||(De=[pe(C,"input",n[33]),pe(U,"click",n[34]),pe(p,"click",n[35]),pe(G,"click",n[36])],ve=!0)},p(_,x){x[0]&2&&C.value!==_[1]&&Xe(C,_[1]),_[15]&&_[4].size===0?_e?_e.p(_,x):(_e=Ot(_),_e.c(),_e.m(q,null)):_e&&(_e.d(1),_e=null),x[0]&1&&R!==(R=_[0].length+"")&&Ee(H,R),x[0]&4&&T!==(T="inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium transition-all "+(_[2]==="all"?"bg-background text-foreground shadow-sm":""))&&r(U,"class",T),x[0]&262144&&Ee(V,_[18]),x[0]&4&&j!==(j="inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium transition-all "+(_[2]==="scraped"?"bg-background text-foreground shadow-sm":""))&&r(p,"class",j),x[0]&131072&&Ee(O,_[17]),x[0]&4&&v!==(v="inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium transition-all "+(_[2]==="unscraped"?"bg-background text-foreground shadow-sm":""))&&r(G,"class",v),ue===(ue=Ce(_))&&we?we.p(_,x):(we.d(1),we=ue(_),we&&(we.c(),we.m(Q,null))),_[4].size>0||_[14]?$?($.p(_,x),x[0]&16400&&Se($,1)):($=Ut(_),$.c(),Se($,1),$.m(e,null)):$&&(ht(),We($,1,1,()=>{$=null}),ft()),x[0]&16400&&Nt(e,"pb-24",_[4].size>0||_[14]),_[5]&&_[6]?S?(S.p(_,x),x[0]&96&&Se(S,1)):(S=St(_),S.c(),Se(S,1),S.m(ge.parentNode,ge)):S&&(ht(),We(S,1,1,()=>{S=null}),ft()),_[7]?ne?(ne.p(_,x),x[0]&128&&Se(ne,1)):(ne=qt(_),ne.c(),Se(ne,1),ne.m(ke.parentNode,ke)):ne&&(ht(),We(ne,1,1,()=>{ne=null}),ft()),_[11]?ie?(ie.p(_,x),x[0]&2048&&Se(ie,1)):(ie=Kt(_),ie.c(),Se(ie,1),ie.m(me.parentNode,me)):ie&&(ht(),We(ie,1,1,()=>{ie=null}),ft())},i(_){Se($),Se(S),Se(ne),Se(ie)},o(_){We($),We(S),We(ne),We(ie)},d(_){_&&(o(e),o(de),o(ge),o(ke),o(me)),_e&&_e.d(),we.d(),$&&$.d(),S&&S.d(_),ne&&ne.d(_),ie&&ie.d(_),ve=!1,et(De)}}}const Wt=n=>!n.movie.tmdbId;function Ds(n,e,t){let s,a,i,c=[],m=!0,k=new Set,Y="",C="all",W=!1,q=null,D=!1,g="",N=[],U=!1,I=!1,R="manual",H=[],B=0,T=!1,M="",p=new Map,w=new Set,V=null,b={current:0,total:0};function j(h){h.item&&w.has(h.item)&&(p.set(h.item,h.percent),p=p,t(15,M=h.message||"")),h.type==="complete"&&w.size>0&&setTimeout(()=>{p.clear(),p=p,w.clear()},2e3)}Yt(async()=>{try{t(0,c=await Je())}catch(h){console.error(h)}finally{t(3,m=!1)}V=es(j)}),Zt(()=>{V&&V()});function L(h,Z){if(Z.shiftKey&&k.size>0){const K=s.map(ze=>ze.path),fe=Array.from(k).pop(),Ie=K.indexOf(fe),je=K.indexOf(h),[Ae,Ke]=Ie<je?[Ie,je]:[je,Ie];for(let ze=Ae;ze<=Ke;ze++)k.add(K[ze])}else Z.ctrlKey||Z.metaKey?k.has(h)?k.delete(h):k.add(h):(k.clear(),k.add(h));t(4,k)}function G(){k.size===s.length?k.clear():s.forEach(h=>k.add(h.path)),t(4,k)}function z(h){t(6,q=h),t(5,W=!0)}function O(){t(5,W=!1),t(6,q=null)}async function P(){if(g.trim()){t(10,U=!0);try{t(9,N=await ts("movie",g))}catch(h){console.error(h)}finally{t(10,U=!1)}}}function v(h){t(6,q=h),t(8,g=h.name),t(7,D=!0),P()}function A(){t(7,D=!1),t(9,N=[])}async function Q(h){if(!q||T)return;if(H.length>0&&B<H.length){t(13,H[B].match={id:h.id,name:h.title||h.name},H),A(),B++,await me();return}const Z=q.path;t(14,T=!0),t(15,M=`正在匹配 ${h.title||h.name}...`);try{const K=await pt("movie",Z,h.id);if(K.success){t(15,M="匹配成功，已创建元数据"),t(3,m=!0),t(0,c=[]);const fe=await Je();t(0,c=[...fe]),t(3,m=!1)}else t(15,M=`匹配失败: ${K.message}`)}catch(K){t(15,M=`错误: ${K}`)}t(14,T=!1),A(),setTimeout(()=>{t(15,M="")},3e3)}function ce(){if(T)return;const Z=Array.from(k).map(fe=>c.find(Ie=>Ie.path===fe)).filter(fe=>fe!==void 0);Z.some(fe=>!fe.tmdbId)?(t(13,H=Z.map(fe=>({movie:fe}))),t(11,I=!0)):de()}async function de(){t(14,T=!0),t(15,M="正在刷新元数据...");const h=Array.from(k);t(16,b={current:0,total:h.length});for(const Z of h)p.set(Z,0);p=p;for(const Z of h){const K=c.find(je=>je.path===Z);if(!K||!K.tmdbId){t(16,b.current++,b),t(16,b),p.set(Z,100),p=p;continue}t(15,M=`正在刷新 (${b.current+1}/${b.total}): ${K.name}`),(await pt("movie",K.path,K.tmdbId)).success,t(16,b.current++,b),t(16,b);const Ie=await Je();t(0,c=[...Ie])}t(15,M=""),t(14,T=!1),k.clear(),t(4,k),setTimeout(()=>{t(16,b={current:0,total:0})},2e3)}async function ge(){t(11,I=!1),R==="ai"?await ke():(B=0,await me())}async function ke(){t(14,T=!0),t(15,M="正在使用 AI 自动匹配并刮削...");const h=[];for(const{movie:K}of H)if(K.tmdbId)h.push({sourcePath:K.path,kind:"movie",tmdbId:K.tmdbId});else{const fe=await ss(K.path,"movie",K.name,K.year);fe.matched&&fe.result?h.push({sourcePath:K.path,kind:"movie",tmdbId:fe.result.id}):fe.candidates.length>0&&h.push({sourcePath:K.path,kind:"movie",candidates:fe.candidates.map(Ie=>({id:Ie.id,name:Ie.name}))})}if(h.length>0){for(const fe of h)p.set(fe.sourcePath,0),w.add(fe.sourcePath);p=p,w=w;const K=await rs(h,"ai");t(15,M=`完成: ${K.processed} 成功, ${K.failed} 失败`)}else t(15,M="没有可处理的项目");t(14,T=!1);const Z=await Je();t(0,c=[...Z]),k.clear(),t(4,k),t(13,H=[]),setTimeout(()=>{t(15,M="")},3e3)}async function me(){if(B>=H.length){await ve();return}const h=H[B];if(h.movie.tmdbId){h.match={id:h.movie.tmdbId},B++,await me();return}t(6,q=h.movie),t(8,g=h.movie.name+(h.movie.year?` ${h.movie.year}`:"")),t(7,D=!0),await P()}async function ve(){t(14,T=!0),t(15,M="正在刮削..."),t(16,b={current:0,total:H.length});for(const{movie:h}of H)p.set(h.path,0);p=p;for(const{movie:h,match:Z}of H){if(!(Z!=null&&Z.id)){t(16,b.current++,b),t(16,b),p.set(h.path,100),p=p;continue}t(15,M=`正在刮削 (${b.current+1}/${b.total}): ${h.name}`),(await pt("movie",h.path,Z.id)).success,t(16,b.current++,b),t(16,b);const fe=await Je();t(0,c=[...fe])}t(15,M=""),t(14,T=!1),k.clear(),t(4,k),t(13,H=[]),setTimeout(()=>{t(16,b={current:0,total:0})},2e3)}function De(){const h=Array.from(k)[0],Z=c.find(K=>K.path===h);Z&&v(Z)}async function _e(h){if(!T){if(!h.tmdbId){t(15,M='未刮削电影需要先匹配 TMDB，请点击"重新匹配"'),setTimeout(()=>{t(15,M="")},5e3);return}t(14,T=!0),t(15,M="正在刷新元数据...");try{const Z=await pt("movie",h.path,h.tmdbId);t(15,M=Z.success?"刷新成功":`失败: ${Z.message}`);const K=await Je();t(0,c=[...K])}catch(Z){t(15,M=`错误: ${Z}`)}t(14,T=!1),setTimeout(()=>{t(15,M="")},3e3)}}const Ce=[[]];function ue(){Y=this.value,t(1,Y)}const we=()=>t(2,C="all"),$=()=>t(2,C="scraped"),S=()=>t(2,C="unscraped"),ne=h=>{k.has(h.path)?k.delete(h.path):k.add(h.path),t(4,k)},ie=h=>z(h),_=h=>v(h),x=(h,Z)=>L(h.path,Z),oe=h=>z(h),be=()=>{q&&_e(q)},Pe=()=>{const h=q;O(),h&&v(h)};function Me(){g=this.value,t(8,g)}const xe=h=>h.key==="Enter"&&P(),Be=h=>Q(h),ae=()=>t(11,I=!1),F=()=>t(11,I=!1);function ee(){R=this.__value,t(12,R)}function Te(){R=this.__value,t(12,R)}const Ue=()=>t(11,I=!1);return n.$$.update=()=>{n.$$.dirty[0]&7&&t(19,s=c.filter(h=>!(C==="scraped"&&!h.isProcessed||C==="unscraped"&&h.isProcessed||Y&&!h.name.toLowerCase().includes(Y.toLowerCase())))),n.$$.dirty[0]&1&&t(18,a=c.filter(h=>h.isProcessed).length),n.$$.dirty[0]&1&&t(17,i=c.filter(h=>!h.isProcessed).length)},[c,Y,C,m,k,W,q,D,g,N,U,I,R,H,T,M,b,i,a,s,L,G,z,O,P,v,A,Q,ce,de,ge,De,_e,ue,we,$,S,ne,ie,_,x,oe,be,Pe,Me,xe,Be,ae,F,ee,Ce,Te,Ue]}class Vs extends Jt{constructor(e){super(),Xt(this,e,Ds,Ts,Qt,{},null,[-1,-1,-1])}}export{Vs as component};
