import{s as sl,r as nt,d as vt,o as rl,n as Qe,e as Tt}from"../chunks/UNimWYyO.js";import{S as nl,i as al,d,q as yt,k as gt,l as ht,s as se,u as St,v as Ue,w as It,a as S,b as s,r as me,m as o,c as h,e as v,n as z,g as y,f as D,x as pt,h as p,j as E,t as T,y as ol,z as Je,A as il,o as te,p as le,B as ul,C as At}from"../chunks/rPDuuC_j.js";import{e as Xe,b as cl,s as dl,d as Bt,p as Mt,g as Vt,h as fl,i as hl}from"../chunks/p95UxV7J.js";import{q as kt,s as xt,f as wt}from"../chunks/Crnc-Z4a.js";function Ot(r,e,t){const l=r.slice();return l[59]=e[t],l}function Lt(r,e,t){const l=r.slice();return l[62]=e[t],l[64]=t,l}function jt(r,e,t){const l=r.slice();return l[65]=e[t],l}function Ht(r,e,t){const l=r.slice();return l[68]=e[t],l}function pl(r){let e,t=Xe(r[2]),l=[];for(let a=0;a<t.length;a+=1)l[a]=Ft(Ht(r,t,a));return{c(){for(let a=0;a<l.length;a+=1)l[a].c();e=pt()},l(a){for(let i=0;i<l.length;i+=1)l[i].l(a);e=pt()},m(a,i){for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(a,i);S(a,e,i)},p(a,i){if(i[0]&134217796){t=Xe(a[2]);let n;for(n=0;n<t.length;n+=1){const u=Ht(a,t,n);l[n]?l[n].p(u,i):(l[n]=Ft(u),l[n].c(),l[n].m(e.parentNode,e))}for(;n<l.length;n+=1)l[n].d(1);l.length=t.length}},d(a){a&&d(e),yt(l,a)}}}function _l(r){let e,t="暂无文件";return{c(){e=p("div"),e.textContent=t,this.h()},l(l){e=h(l,"DIV",{class:!0,"data-svelte-h":!0}),z(e)!=="svelte-1r2i36z"&&(e.textContent=t),this.h()},h(){o(e,"class","p-4 text-center text-muted-foreground text-sm")},m(l,a){S(l,e,a)},p:Qe,d(l){l&&d(e)}}}function vl(r){let e,t="加载中...";return{c(){e=p("div"),e.textContent=t,this.h()},l(l){e=h(l,"DIV",{class:!0,"data-svelte-h":!0}),z(e)!=="svelte-1kp6rjy"&&(e.textContent=t),this.h()},h(){o(e,"class","p-4 text-center text-muted-foreground text-sm")},m(l,a){S(l,e,a)},p:Qe,d(l){l&&d(e)}}}function Ft(r){let e,t,l,a,i,n=r[68].name+"",u,c,f,m,g=r[68].files.length+"",k,b,_,w,P,O;function j(){return r[40](r[68])}return{c(){e=p("button"),t=le("svg"),l=le("path"),a=E(),i=p("span"),u=T(n),c=E(),f=p("span"),m=T("("),k=T(g),b=T(")"),_=E(),this.h()},l(V){e=h(V,"BUTTON",{class:!0});var C=v(e);t=te(C,"svg",{class:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var N=v(t);l=te(N,"path",{d:!0}),v(l).forEach(d),N.forEach(d),a=y(C),i=h(C,"SPAN",{class:!0});var I=v(i);u=D(I,n),I.forEach(d),c=y(C),f=h(C,"SPAN",{class:!0});var H=v(f);m=D(H,"("),k=D(H,g),b=D(H,")"),H.forEach(d),_=y(C),C.forEach(d),this.h()},h(){o(l,"d","M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"),o(t,"class","h-4 w-4 text-primary"),o(t,"viewBox","0 0 24 24"),o(t,"fill","none"),o(t,"stroke","currentColor"),o(t,"stroke-width","2"),o(i,"class","flex-1 truncate"),o(f,"class","text-xs text-muted-foreground"),o(e,"class",w="flex items-center gap-2 w-full px-3 py-2 text-sm text-left hover:bg-accent/50 "+(r[6]===r[68].path?"bg-accent/30 border-l-2 border-l-primary":""))},m(V,C){S(V,e,C),s(e,t),s(t,l),s(e,a),s(e,i),s(i,u),s(e,c),s(e,f),s(f,m),s(f,k),s(f,b),s(e,_),P||(O=me(e,"click",j),P=!0)},p(V,C){r=V,C[0]&4&&n!==(n=r[68].name+"")&&se(u,n),C[0]&4&&g!==(g=r[68].files.length+"")&&se(k,g),C[0]&68&&w!==(w="flex items-center gap-2 w-full px-3 py-2 text-sm text-left hover:bg-accent/50 "+(r[6]===r[68].path?"bg-accent/30 border-l-2 border-l-primary":""))&&o(e,"class",w)},d(V){V&&d(e),P=!1,O()}}}function ml(r){let e,t,l;return{c(){e=le("svg"),t=le("path"),l=le("path"),this.h()},l(a){e=te(a,"svg",{class:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var i=v(e);t=te(i,"path",{d:!0}),v(t).forEach(d),l=te(i,"path",{d:!0}),v(l).forEach(d),i.forEach(d),this.h()},h(){o(t,"d","M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"),o(l,"d","M14 2v4a2 2 0 0 0 2 2h4"),o(e,"class","h-4 w-4 text-muted-foreground shrink-0"),o(e,"viewBox","0 0 24 24"),o(e,"fill","none"),o(e,"stroke","currentColor"),o(e,"stroke-width","2")},m(a,i){S(a,e,i),s(e,t),s(e,l)},d(a){a&&d(e)}}}function bl(r){let e,t,l,a,i,n,u,c,f;return{c(){e=le("svg"),t=le("rect"),l=le("path"),a=le("path"),i=le("path"),n=le("path"),u=le("path"),c=le("path"),f=le("path"),this.h()},l(m){e=te(m,"svg",{class:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var g=v(e);t=te(g,"rect",{width:!0,height:!0,x:!0,y:!0,rx:!0}),v(t).forEach(d),l=te(g,"path",{d:!0}),v(l).forEach(d),a=te(g,"path",{d:!0}),v(a).forEach(d),i=te(g,"path",{d:!0}),v(i).forEach(d),n=te(g,"path",{d:!0}),v(n).forEach(d),u=te(g,"path",{d:!0}),v(u).forEach(d),c=te(g,"path",{d:!0}),v(c).forEach(d),f=te(g,"path",{d:!0}),v(f).forEach(d),g.forEach(d),this.h()},h(){o(t,"width","18"),o(t,"height","18"),o(t,"x","3"),o(t,"y","3"),o(t,"rx","2"),o(l,"d","M7 3v18"),o(a,"d","M3 7.5h4"),o(i,"d","M3 12h18"),o(n,"d","M3 16.5h4"),o(u,"d","M17 3v18"),o(c,"d","M17 7.5h4"),o(f,"d","M17 16.5h4"),o(e,"class","h-4 w-4 text-primary shrink-0"),o(e,"viewBox","0 0 24 24"),o(e,"fill","none"),o(e,"stroke","currentColor"),o(e,"stroke-width","2")},m(m,g){S(m,e,g),s(e,t),s(e,l),s(e,a),s(e,i),s(e,n),s(e,u),s(e,c),s(e,f)},d(m){m&&d(e)}}}function gl(r){let e,t="-";return{c(){e=p("span"),e.textContent=t,this.h()},l(l){e=h(l,"SPAN",{class:!0,"data-svelte-h":!0}),z(e)!=="svelte-hbapjm"&&(e.textContent=t),this.h()},h(){o(e,"class","text-xs text-muted-foreground")},m(l,a){S(l,e,a)},p:Qe,d(l){l&&d(e)}}}function kl(r){let e,t,l=r[65].parsed.title+"",a,i,n,u,c,f=r[65].parsed.season!==void 0&&Ut(r),m=r[65].parsed.episode!==void 0&&zt(r),g=r[65].parsed.resolution&&qt(r),k=r[65].parsed.codec&&Rt(r);return{c(){e=p("div"),t=p("span"),a=T(l),i=E(),f&&f.c(),n=E(),m&&m.c(),u=E(),g&&g.c(),c=E(),k&&k.c(),this.h()},l(b){e=h(b,"DIV",{class:!0});var _=v(e);t=h(_,"SPAN",{});var w=v(t);a=D(w,l),w.forEach(d),i=y(_),f&&f.l(_),n=y(_),m&&m.l(_),u=y(_),g&&g.l(_),c=y(_),k&&k.l(_),_.forEach(d),this.h()},h(){o(e,"class","flex items-center gap-2 text-xs")},m(b,_){S(b,e,_),s(e,t),s(t,a),s(e,i),f&&f.m(e,null),s(e,n),m&&m.m(e,null),s(e,u),g&&g.m(e,null),s(e,c),k&&k.m(e,null)},p(b,_){_[0]&33554432&&l!==(l=b[65].parsed.title+"")&&se(a,l),b[65].parsed.season!==void 0?f?f.p(b,_):(f=Ut(b),f.c(),f.m(e,n)):f&&(f.d(1),f=null),b[65].parsed.episode!==void 0?m?m.p(b,_):(m=zt(b),m.c(),m.m(e,u)):m&&(m.d(1),m=null),b[65].parsed.resolution?g?g.p(b,_):(g=qt(b),g.c(),g.m(e,c)):g&&(g.d(1),g=null),b[65].parsed.codec?k?k.p(b,_):(k=Rt(b),k.c(),k.m(e,null)):k&&(k.d(1),k=null)},d(b){b&&d(e),f&&f.d(),m&&m.d(),g&&g.d(),k&&k.d()}}}function Ut(r){let e,t,l=String(r[65].parsed.season).padStart(2,"0")+"",a;return{c(){e=p("span"),t=T("S"),a=T(l),this.h()},l(i){e=h(i,"SPAN",{class:!0});var n=v(e);t=D(n,"S"),a=D(n,l),n.forEach(d),this.h()},h(){o(e,"class","text-muted-foreground")},m(i,n){S(i,e,n),s(e,t),s(e,a)},p(i,n){n[0]&33554432&&l!==(l=String(i[65].parsed.season).padStart(2,"0")+"")&&se(a,l)},d(i){i&&d(e)}}}function zt(r){let e,t,l=String(r[65].parsed.episode).padStart(2,"0")+"",a;return{c(){e=p("span"),t=T("E"),a=T(l),this.h()},l(i){e=h(i,"SPAN",{class:!0});var n=v(e);t=D(n,"E"),a=D(n,l),n.forEach(d),this.h()},h(){o(e,"class","text-muted-foreground")},m(i,n){S(i,e,n),s(e,t),s(e,a)},p(i,n){n[0]&33554432&&l!==(l=String(i[65].parsed.episode).padStart(2,"0")+"")&&se(a,l)},d(i){i&&d(e)}}}function qt(r){let e,t=r[65].parsed.resolution+"",l;return{c(){e=p("span"),l=T(t),this.h()},l(a){e=h(a,"SPAN",{class:!0});var i=v(e);l=D(i,t),i.forEach(d),this.h()},h(){o(e,"class","rounded bg-secondary px-1 py-0.5 text-[10px]")},m(a,i){S(a,e,i),s(e,l)},p(a,i){i[0]&33554432&&t!==(t=a[65].parsed.resolution+"")&&se(l,t)},d(a){a&&d(e)}}}function Rt(r){let e,t=r[65].parsed.codec+"",l;return{c(){e=p("span"),l=T(t),this.h()},l(a){e=h(a,"SPAN",{class:!0});var i=v(e);l=D(i,t),i.forEach(d),this.h()},h(){o(e,"class","rounded bg-secondary px-1 py-0.5 text-[10px]")},m(a,i){S(a,e,i),s(e,l)},p(a,i){i[0]&33554432&&t!==(t=a[65].parsed.codec+"")&&se(l,t)},d(a){a&&d(e)}}}function Zt(r){let e,t,l,a,i,n,u,c,f,m=r[65].relativePath+"",g,k,b,_,w,P,O,j;function V(){return r[43](r[65])}function C(R,U){return R[65].kind!=="unknown"?bl:ml}let N=C(r),I=N(r);function H(R,U){return R[65].parsed.title?kl:gl}let F=H(r),B=F(r);function re(...R){return r[44](r[65],...R)}function G(){return r[45](r[65])}return{c(){e=p("tr"),t=p("td"),l=p("input"),i=E(),n=p("td"),u=p("div"),I.c(),c=E(),f=p("span"),g=T(m),b=E(),_=p("td"),B.c(),w=E(),this.h()},l(R){e=h(R,"TR",{class:!0});var U=v(e);t=h(U,"TD",{class:!0});var we=v(t);l=h(we,"INPUT",{type:!0,class:!0}),we.forEach(d),i=y(U),n=h(U,"TD",{class:!0});var Y=v(n);u=h(Y,"DIV",{class:!0});var J=v(u);I.l(J),c=y(J),f=h(J,"SPAN",{class:!0,title:!0});var _e=v(f);g=D(_e,m),_e.forEach(d),J.forEach(d),Y.forEach(d),b=y(U),_=h(U,"TD",{class:!0});var fe=v(_);B.l(fe),fe.forEach(d),w=y(U),U.forEach(d),this.h()},h(){o(l,"type","checkbox"),o(l,"class","h-4 w-4 rounded border-input accent-primary"),l.checked=a=r[3].has(r[65].path),o(t,"class","p-2"),o(f,"class","font-mono text-xs truncate max-w-[400px]"),o(f,"title",k=r[65].relativePath),o(u,"class","flex items-center gap-2"),o(n,"class","p-2"),o(_,"class","p-2"),o(e,"class",P="border-b border-border hover:bg-accent/50 cursor-pointer "+(r[3].has(r[65].path)?"bg-accent/30 border-l-2 border-l-primary":""))},m(R,U){S(R,e,U),s(e,t),s(t,l),s(e,i),s(e,n),s(n,u),I.m(u,null),s(u,c),s(u,f),s(f,g),s(e,b),s(e,_),B.m(_,null),s(e,w),O||(j=[me(l,"click",ul(V)),me(e,"click",re),me(e,"dblclick",G)],O=!0)},p(R,U){r=R,U[0]&33554440&&a!==(a=r[3].has(r[65].path))&&(l.checked=a),N!==(N=C(r))&&(I.d(1),I=N(r),I&&(I.c(),I.m(u,c))),U[0]&33554432&&m!==(m=r[65].relativePath+"")&&se(g,m),U[0]&33554432&&k!==(k=r[65].relativePath)&&o(f,"title",k),F===(F=H(r))&&B?B.p(r,U):(B.d(1),B=F(r),B&&(B.c(),B.m(_,null))),U[0]&33554440&&P!==(P="border-b border-border hover:bg-accent/50 cursor-pointer "+(r[3].has(r[65].path)?"bg-accent/30 border-l-2 border-l-primary":""))&&o(e,"class",P)},d(R){R&&d(e),I.d(),B.d(),O=!1,nt(j)}}}function xl(r){let e,t,l=r[3].size+"",a,i,n,u,c,f,m,g;return{c(){e=p("span"),t=T("已选 "),a=T(l),i=T(" 个文件:"),n=E(),u=p("button"),c=T("一键刮削"),this.h()},l(k){e=h(k,"SPAN",{class:!0});var b=v(e);t=D(b,"已选 "),a=D(b,l),i=D(b," 个文件:"),b.forEach(d),n=y(k),u=h(k,"BUTTON",{class:!0});var _=v(u);c=D(_,"一键刮削"),_.forEach(d),this.h()},h(){o(e,"class","text-xs text-muted-foreground"),o(u,"class","inline-flex items-center justify-center rounded-md text-xs font-medium h-8 px-3 bg-primary text-primary-foreground hover:opacity-90 disabled:opacity-50"),u.disabled=f=r[3].size===0||r[14]},m(k,b){S(k,e,b),s(e,t),s(e,a),s(e,i),S(k,n,b),S(k,u,b),s(u,c),m||(g=me(u,"click",r[33]),m=!0)},p(k,b){b[0]&8&&l!==(l=k[3].size+"")&&se(a,l),b[0]&16392&&f!==(f=k[3].size===0||k[14])&&(u.disabled=f)},d(k){k&&(d(e),d(n),d(u)),m=!1,g()}}}function wl(r){let e,t,l,a=r[20]+1+"",i,n,u=r[19].length+"",c,f,m,g,k="确认并处理",b,_,w="跳过",P,O;return{c(){e=p("div"),t=p("span"),l=T("手动匹配 "),i=T(a),n=T("/"),c=T(u),f=T(":"),m=E(),g=p("button"),g.textContent=k,b=E(),_=p("button"),_.textContent=w,this.h()},l(j){e=h(j,"DIV",{class:!0});var V=v(e);t=h(V,"SPAN",{class:!0});var C=v(t);l=D(C,"手动匹配 "),i=D(C,a),n=D(C,"/"),c=D(C,u),f=D(C,":"),C.forEach(d),m=y(V),g=h(V,"BUTTON",{class:!0,"data-svelte-h":!0}),z(g)!=="svelte-43vj51"&&(g.textContent=k),b=y(V),_=h(V,"BUTTON",{class:!0,"data-svelte-h":!0}),z(_)!=="svelte-tyll7y"&&(_.textContent=w),V.forEach(d),this.h()},h(){o(t,"class","text-xs text-muted-foreground"),o(g,"class","inline-flex items-center justify-center rounded-md text-xs font-medium h-8 px-3 bg-primary text-primary-foreground hover:opacity-90"),o(_,"class","inline-flex items-center justify-center rounded-md text-xs font-medium h-8 px-3 border border-input bg-background hover:bg-accent"),o(e,"class","flex items-center gap-2 flex-1")},m(j,V){S(j,e,V),s(e,t),s(t,l),s(t,i),s(t,n),s(t,c),s(t,f),s(e,m),s(e,g),s(e,b),s(e,_),P||(O=[me(g,"click",r[35]),me(_,"click",r[37])],P=!0)},p(j,V){V[0]&1048576&&a!==(a=j[20]+1+"")&&se(i,a),V[0]&524288&&u!==(u=j[19].length+"")&&se(c,u)},d(j){j&&d(e),P=!1,nt(O)}}}function yl(r){let e,t,l,a,i,n,u,c=r[16].total>0&&Kt(r);return{c(){e=p("div"),t=le("svg"),l=le("path"),a=E(),i=p("span"),n=T(r[15]),u=E(),c&&c.c(),this.h()},l(f){e=h(f,"DIV",{class:!0});var m=v(e);t=te(m,"svg",{class:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var g=v(t);l=te(g,"path",{d:!0}),v(l).forEach(d),g.forEach(d),a=y(m),i=h(m,"SPAN",{class:!0});var k=v(i);n=D(k,r[15]),k.forEach(d),u=y(m),c&&c.l(m),m.forEach(d),this.h()},h(){o(l,"d","M21 12a9 9 0 1 1-6.219-8.56"),o(t,"class","h-4 w-4 animate-spin text-primary"),o(t,"viewBox","0 0 24 24"),o(t,"fill","none"),o(t,"stroke","currentColor"),o(t,"stroke-width","2"),o(i,"class","text-xs font-medium"),o(e,"class","flex items-center gap-2 flex-1")},m(f,m){S(f,e,m),s(e,t),s(t,l),s(e,a),s(e,i),s(i,n),s(e,u),c&&c.m(e,null)},p(f,m){m[0]&32768&&se(n,f[15]),f[16].total>0?c?c.p(f,m):(c=Kt(f),c.c(),c.m(e,null)):c&&(c.d(1),c=null)},d(f){f&&d(e),c&&c.d()}}}function Kt(r){let e,t,l=r[16].current+"",a,i,n=r[16].total+"",u,c;return{c(){e=p("span"),t=T("("),a=T(l),i=T("/"),u=T(n),c=T(")"),this.h()},l(f){e=h(f,"SPAN",{class:!0});var m=v(e);t=D(m,"("),a=D(m,l),i=D(m,"/"),u=D(m,n),c=D(m,")"),m.forEach(d),this.h()},h(){o(e,"class","text-xs text-muted-foreground")},m(f,m){S(f,e,m),s(e,t),s(e,a),s(e,i),s(e,u),s(e,c)},p(f,m){m[0]&65536&&l!==(l=f[16].current+"")&&se(a,l),m[0]&65536&&n!==(n=f[16].total+"")&&se(u,n)},d(f){f&&d(e)}}}function El(r){let e,t='<p>选择一个文件查看详情</p> <p class="text-xs mt-1">单击选择，双击打开详情，Shift/Ctrl 多选</p>';return{c(){e=p("div"),e.innerHTML=t,this.h()},l(l){e=h(l,"DIV",{class:!0,"data-svelte-h":!0}),z(e)!=="svelte-1e1jxu6"&&(e.innerHTML=t),this.h()},h(){o(e,"class","text-center py-8 text-muted-foreground text-sm")},m(l,a){S(l,e,a)},p:Qe,d(l){l&&d(e)}}}function Cl(r){let e,t,l,a="解析:",i,n,u,c,f,m=(r[4].parsed.title||"?")+"",g,k,b,_,w,P=(r[4].parsed.year||"?")+"",O,j,V,C,N,I=(r[4].parsed.season??"?")+"",H,F,B,re,G,R=(r[4].parsed.episode??"?")+"",U,we,Y,J,_e,fe=(r[4].parsed.resolution||"?")+"",ie,De,X,K,q,$=(r[4].parsed.codec||"?")+"",oe,ge,ne,ve,ke,Se="自动匹配:",ze,Ie,Me,Ge="手动搜索",Ve,qe,Oe,He="候选列表:",Re,Pe,Ze,Ee,Ne,$e="入库目标:",Ke,x,M,W,Z,be,Fe,Le,ye,Ce,ce,at,et;function Ae(L,ue){return L[11]?Dl:L[8]?Nl:Pl}let tt=Ae(r),Te=tt(r),de=r[12]!==""&&Qt(r),he=Xe(r[7]),Q=[];for(let L=0;L<he.length;L+=1)Q[L]=Gt(Lt(r,he,L));function A(L,ue){return L[14]?Al:Il}let ae=A(r),ee=ae(r);return{c(){e=p("div"),t=p("div"),l=p("div"),l.textContent=a,i=E(),n=p("div"),u=p("span"),c=T("标题="),f=p("span"),g=T(m),k=E(),b=p("span"),_=T("年份="),w=p("span"),O=T(P),j=E(),V=p("span"),C=T("季="),N=p("span"),H=T(I),F=E(),B=p("span"),re=T("集="),G=p("span"),U=T(R),we=E(),Y=p("span"),J=T("分辨率="),_e=p("span"),ie=T(fe),De=E(),X=p("span"),K=T("编码="),q=p("span"),oe=T($),ge=E(),ne=p("div"),ve=p("div"),ke=p("span"),ke.textContent=Se,ze=E(),Te.c(),Ie=E(),Me=p("button"),Me.textContent=Ge,Ve=E(),de&&de.c(),qe=E(),Oe=p("div"),Oe.textContent=He,Re=E(),Pe=p("div");for(let L=0;L<Q.length;L+=1)Q[L].c();Ze=E(),Ee=p("div"),Ne=p("div"),Ne.textContent=$e,Ke=E(),x=p("div"),M=p("input"),W=E(),Z=p("button"),be=T("预览移动计划"),Le=E(),ye=p("div"),Ce=p("button"),ee.c(),this.h()},l(L){e=h(L,"DIV",{class:!0});var ue=v(e);t=h(ue,"DIV",{});var pe=v(t);l=h(pe,"DIV",{class:!0,"data-svelte-h":!0}),z(l)!=="svelte-uhi4zi"&&(l.textContent=a),i=y(pe),n=h(pe,"DIV",{class:!0});var xe=v(n);u=h(xe,"SPAN",{});var Ye=v(u);c=D(Ye,"标题="),f=h(Ye,"SPAN",{class:!0});var ot=v(f);g=D(ot,m),ot.forEach(d),Ye.forEach(d),k=y(xe),b=h(xe,"SPAN",{});var Be=v(b);_=D(Be,"年份="),w=h(Be,"SPAN",{class:!0});var lt=v(w);O=D(lt,P),lt.forEach(d),Be.forEach(d),j=y(xe),V=h(xe,"SPAN",{});var it=v(V);C=D(it,"季="),N=h(it,"SPAN",{class:!0});var st=v(N);H=D(st,I),st.forEach(d),it.forEach(d),F=y(xe),B=h(xe,"SPAN",{});var ut=v(B);re=D(ut,"集="),G=h(ut,"SPAN",{class:!0});var We=v(G);U=D(We,R),We.forEach(d),ut.forEach(d),we=y(xe),Y=h(xe,"SPAN",{});var ct=v(Y);J=D(ct,"分辨率="),_e=h(ct,"SPAN",{class:!0});var _t=v(_e);ie=D(_t,fe),_t.forEach(d),ct.forEach(d),De=y(xe),X=h(xe,"SPAN",{});var dt=v(X);K=D(dt,"编码="),q=h(dt,"SPAN",{class:!0});var rt=v(q);oe=D(rt,$),rt.forEach(d),dt.forEach(d),xe.forEach(d),pe.forEach(d),ge=y(ue),ne=h(ue,"DIV",{});var je=v(ne);ve=h(je,"DIV",{class:!0});var ft=v(ve);ke=h(ft,"SPAN",{class:!0,"data-svelte-h":!0}),z(ke)!=="svelte-12idlsy"&&(ke.textContent=Se),ze=y(ft),Te.l(ft),Ie=y(ft),Me=h(ft,"BUTTON",{class:!0,"data-svelte-h":!0}),z(Me)!=="svelte-14ph06c"&&(Me.textContent=Ge),ft.forEach(d),Ve=y(je),de&&de.l(je),qe=y(je),Oe=h(je,"DIV",{class:!0,"data-svelte-h":!0}),z(Oe)!=="svelte-1ovqev0"&&(Oe.textContent=He),Re=y(je),Pe=h(je,"DIV",{class:!0});var Ct=v(Pe);for(let Et=0;Et<Q.length;Et+=1)Q[Et].l(Ct);Ct.forEach(d),je.forEach(d),Ze=y(ue),Ee=h(ue,"DIV",{});var mt=v(Ee);Ne=h(mt,"DIV",{class:!0,"data-svelte-h":!0}),z(Ne)!=="svelte-fduehy"&&(Ne.textContent=$e),Ke=y(mt),x=h(mt,"DIV",{class:!0});var bt=v(x);M=h(bt,"INPUT",{type:!0,class:!0}),W=y(bt),Z=h(bt,"BUTTON",{class:!0});var Pt=v(Z);be=D(Pt,"预览移动计划"),Pt.forEach(d),bt.forEach(d),mt.forEach(d),Le=y(ue),ye=h(ue,"DIV",{class:!0});var Nt=v(ye);Ce=h(Nt,"BUTTON",{class:!0});var Dt=v(Ce);ee.l(Dt),Dt.forEach(d),Nt.forEach(d),ue.forEach(d),this.h()},h(){o(l,"class","text-muted-foreground mb-1"),o(f,"class","text-foreground"),o(w,"class","text-foreground"),o(N,"class","text-foreground"),o(G,"class","text-foreground"),o(_e,"class","text-foreground"),o(q,"class","text-foreground"),o(n,"class","flex flex-wrap gap-x-4 gap-y-1 font-mono"),o(ke,"class","text-muted-foreground"),o(Me,"class","ml-auto inline-flex items-center justify-center rounded-md text-[10px] font-medium h-6 px-2 border border-input bg-background hover:bg-accent"),o(ve,"class","flex items-center gap-2 mb-2"),o(Oe,"class","text-muted-foreground mb-1"),o(Pe,"class","space-y-1"),o(Ne,"class","text-muted-foreground mb-1"),o(M,"type","text"),o(M,"class","flex-1 h-7 rounded-md border border-input bg-background px-2 text-xs"),M.readOnly=!0,o(Z,"class","inline-flex items-center justify-center rounded-md text-[10px] font-medium h-7 px-2 border border-input bg-background hover:bg-accent disabled:opacity-50"),Z.disabled=Fe=!r[8],o(x,"class","flex gap-2"),o(Ce,"class","w-full inline-flex items-center justify-center rounded-md text-sm font-medium h-9 px-4 bg-primary text-primary-foreground hover:opacity-90 disabled:opacity-50"),Ce.disabled=ce=!r[8]||r[14],o(ye,"class","pt-2"),o(e,"class","space-y-4 text-xs")},m(L,ue){S(L,e,ue),s(e,t),s(t,l),s(t,i),s(t,n),s(n,u),s(u,c),s(u,f),s(f,g),s(n,k),s(n,b),s(b,_),s(b,w),s(w,O),s(n,j),s(n,V),s(V,C),s(V,N),s(N,H),s(n,F),s(n,B),s(B,re),s(B,G),s(G,U),s(n,we),s(n,Y),s(Y,J),s(Y,_e),s(_e,ie),s(n,De),s(n,X),s(X,K),s(X,q),s(q,oe),s(e,ge),s(e,ne),s(ne,ve),s(ve,ke),s(ve,ze),Te.m(ve,null),s(ve,Ie),s(ve,Me),s(ne,Ve),de&&de.m(ne,null),s(ne,qe),s(ne,Oe),s(ne,Re),s(ne,Pe);for(let pe=0;pe<Q.length;pe+=1)Q[pe]&&Q[pe].m(Pe,null);s(e,Ze),s(e,Ee),s(Ee,Ne),s(Ee,Ke),s(Ee,x),s(x,M),Ue(M,r[13]),s(x,W),s(x,Z),s(Z,be),s(e,Le),s(e,ye),s(ye,Ce),ee.m(Ce,null),at||(et=[me(Me,"click",r[46]),me(M,"input",r[49]),me(Z,"click",r[38]),me(Ce,"click",r[36])],at=!0)},p(L,ue){if(ue[0]&16&&m!==(m=(L[4].parsed.title||"?")+"")&&se(g,m),ue[0]&16&&P!==(P=(L[4].parsed.year||"?")+"")&&se(O,P),ue[0]&16&&I!==(I=(L[4].parsed.season??"?")+"")&&se(H,I),ue[0]&16&&R!==(R=(L[4].parsed.episode??"?")+"")&&se(U,R),ue[0]&16&&fe!==(fe=(L[4].parsed.resolution||"?")+"")&&se(ie,fe),ue[0]&16&&$!==($=(L[4].parsed.codec||"?")+"")&&se(oe,$),tt===(tt=Ae(L))&&Te?Te.p(L,ue):(Te.d(1),Te=tt(L),Te&&(Te.c(),Te.m(ve,Ie))),L[12]!==""?de?de.p(L,ue):(de=Qt(L),de.c(),de.m(ne,qe)):de&&(de.d(1),de=null),ue[0]&384|ue[1]&2){he=Xe(L[7]);let pe;for(pe=0;pe<he.length;pe+=1){const xe=Lt(L,he,pe);Q[pe]?Q[pe].p(xe,ue):(Q[pe]=Gt(xe),Q[pe].c(),Q[pe].m(Pe,null))}for(;pe<Q.length;pe+=1)Q[pe].d(1);Q.length=he.length}ue[0]&8192&&M.value!==L[13]&&Ue(M,L[13]),ue[0]&256&&Fe!==(Fe=!L[8])&&(Z.disabled=Fe),ae!==(ae=A(L))&&(ee.d(1),ee=ae(L),ee&&(ee.c(),ee.m(Ce,null))),ue[0]&16640&&ce!==(ce=!L[8]||L[14])&&(Ce.disabled=ce)},d(L){L&&d(e),Te.d(),de&&de.d(),yt(Q,L),ee.d(),at=!1,nt(et)}}}function Pl(r){let e,t="未找到匹配";return{c(){e=p("span"),e.textContent=t,this.h()},l(l){e=h(l,"SPAN",{class:!0,"data-svelte-h":!0}),z(e)!=="svelte-1ahqgxu"&&(e.textContent=t),this.h()},h(){o(e,"class","text-muted-foreground")},m(l,a){S(l,e,a)},p:Qe,d(l){l&&d(e)}}}function Nl(r){let e,t=(r[8].name||r[8].title)+"",l,a,i,n=r[9]&&Wt(r);return{c(){e=p("span"),l=T(t),a=E(),n&&n.c(),i=pt(),this.h()},l(u){e=h(u,"SPAN",{class:!0});var c=v(e);l=D(c,t),c.forEach(d),a=y(u),n&&n.l(u),i=pt(),this.h()},h(){o(e,"class","font-medium")},m(u,c){S(u,e,c),s(e,l),S(u,a,c),n&&n.m(u,c),S(u,i,c)},p(u,c){c[0]&256&&t!==(t=(u[8].name||u[8].title)+"")&&se(l,t),u[9]?n?n.p(u,c):(n=Wt(u),n.c(),n.m(i.parentNode,i)):n&&(n.d(1),n=null)},d(u){u&&(d(e),d(a),d(i)),n&&n.d(u)}}}function Dl(r){let e,t,l,a,i="搜索中...";return{c(){e=le("svg"),t=le("path"),l=E(),a=p("span"),a.textContent=i,this.h()},l(n){e=te(n,"svg",{class:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var u=v(e);t=te(u,"path",{d:!0}),v(t).forEach(d),u.forEach(d),l=y(n),a=h(n,"SPAN",{class:!0,"data-svelte-h":!0}),z(a)!=="svelte-5oqun1"&&(a.textContent=i),this.h()},h(){o(t,"d","M21 12a9 9 0 1 1-6.219-8.56"),o(e,"class","h-4 w-4 animate-spin text-primary"),o(e,"viewBox","0 0 24 24"),o(e,"fill","none"),o(e,"stroke","currentColor"),o(e,"stroke-width","2"),o(a,"class","text-muted-foreground")},m(n,u){S(n,e,u),s(e,t),S(n,l,u),S(n,a,u)},p:Qe,d(n){n&&(d(e),d(l),d(a))}}}function Wt(r){let e,t,l=(r[10]*100).toFixed(0)+"",a,i,n,u,c=`<svg class="h-3 w-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 6 9 17l-5-5"></path></svg>
                    自动匹配`;return{c(){e=p("span"),t=T("置信度: "),a=T(l),i=T("%"),n=E(),u=p("span"),u.innerHTML=c,this.h()},l(f){e=h(f,"SPAN",{class:!0});var m=v(e);t=D(m,"置信度: "),a=D(m,l),i=D(m,"%"),m.forEach(d),n=y(f),u=h(f,"SPAN",{class:!0,"data-svelte-h":!0}),z(u)!=="svelte-ybbu77"&&(u.innerHTML=c),this.h()},h(){o(e,"class","text-muted-foreground"),o(u,"class","inline-flex items-center gap-1 text-[10px] border border-green-500/50 text-green-500 rounded px-1")},m(f,m){S(f,e,m),s(e,t),s(e,a),s(e,i),S(f,n,m),S(f,u,m)},p(f,m){m[0]&1024&&l!==(l=(f[10]*100).toFixed(0)+"")&&se(a,l)},d(f){f&&(d(e),d(n),d(u))}}}function Qt(r){let e,t,l,a,i=r[11]?"搜索中...":"搜索",n,u,c;return{c(){e=p("div"),t=p("input"),l=E(),a=p("button"),n=T(i),this.h()},l(f){e=h(f,"DIV",{class:!0});var m=v(e);t=h(m,"INPUT",{type:!0,class:!0,placeholder:!0}),l=y(m),a=h(m,"BUTTON",{class:!0});var g=v(a);n=D(g,i),g.forEach(d),m.forEach(d),this.h()},h(){o(t,"type","text"),o(t,"class","flex-1 h-7 rounded-md border border-input bg-background px-2 text-xs"),o(t,"placeholder","输入搜索关键词"),o(a,"class","inline-flex items-center justify-center rounded-md text-[10px] font-medium h-7 px-3 bg-primary text-primary-foreground hover:opacity-90 disabled:opacity-50"),a.disabled=r[11],o(e,"class","flex gap-2 mb-2")},m(f,m){S(f,e,m),s(e,t),Ue(t,r[12]),s(e,l),s(e,a),s(a,n),u||(c=[me(t,"input",r[47]),me(a,"click",r[31])],u=!0)},p(f,m){m[0]&4096&&t.value!==f[12]&&Ue(t,f[12]),m[0]&2048&&i!==(i=f[11]?"搜索中...":"搜索")&&se(n,i),m[0]&2048&&(a.disabled=f[11])},d(f){f&&d(e),u=!1,nt(c)}}}function Tl(r){let e,t='<svg class="h-4 w-4 text-muted-foreground" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect width="18" height="18" x="3" y="3" rx="2"></rect></svg>';return{c(){e=p("div"),e.innerHTML=t,this.h()},l(l){e=h(l,"DIV",{class:!0,"data-svelte-h":!0}),z(e)!=="svelte-18nzw36"&&(e.innerHTML=t),this.h()},h(){o(e,"class","w-8 h-12 bg-muted rounded flex items-center justify-center shrink-0")},m(l,a){S(l,e,a)},p:Qe,d(l){l&&d(e)}}}function Sl(r){let e,t,l;return{c(){e=p("img"),this.h()},l(a){e=h(a,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){Tt(e.src,t=r[62].posterPath)||o(e,"src",t),o(e,"alt",l=r[62].name||r[62].title),o(e,"class","w-8 h-12 object-cover rounded shrink-0")},m(a,i){S(a,e,i)},p(a,i){i[0]&128&&!Tt(e.src,t=a[62].posterPath)&&o(e,"src",t),i[0]&128&&l!==(l=a[62].name||a[62].title)&&o(e,"alt",l)},d(a){a&&d(e)}}}function Gt(r){var fe,ie,De;let e,t,l,a,i=r[64]+1+"",n,u,c,f,m=(r[62].name||r[62].title)+"",g,k,b=(((fe=r[62].firstAirDate)==null?void 0:fe.slice(0,4))||((ie=r[62].releaseDate)==null?void 0:ie.slice(0,4)))+"",_,w,P,O,j,V=r[62].id+"",C,N,I,H=((De=r[8])==null?void 0:De.id)===r[62].id?"已选":"选用",F,B,re,G,R,U;function we(X,K){return X[62].posterPath?Sl:Tl}let Y=we(r),J=Y(r);function _e(){return r[48](r[62])}return{c(){e=p("button"),J.c(),t=E(),l=p("span"),a=T("("),n=T(i),u=T(")"),c=E(),f=p("span"),g=T(m),k=T(" ("),_=T(b),w=T(")"),P=E(),O=p("span"),j=T("#"),C=T(V),N=E(),I=p("span"),F=T(H),re=E(),this.h()},l(X){e=h(X,"BUTTON",{class:!0});var K=v(e);J.l(K),t=y(K),l=h(K,"SPAN",{class:!0});var q=v(l);a=D(q,"("),n=D(q,i),u=D(q,")"),q.forEach(d),c=y(K),f=h(K,"SPAN",{class:!0});var $=v(f);g=D($,m),k=D($," ("),_=D($,b),w=D($,")"),$.forEach(d),P=y(K),O=h(K,"SPAN",{class:!0});var oe=v(O);j=D(oe,"#"),C=D(oe,V),oe.forEach(d),N=y(K),I=h(K,"SPAN",{class:!0});var ge=v(I);F=D(ge,H),ge.forEach(d),re=y(K),K.forEach(d),this.h()},h(){var X,K;o(l,"class","text-muted-foreground"),o(f,"class","flex-1 truncate"),o(O,"class","text-muted-foreground shrink-0"),o(I,"class",B="inline-flex items-center justify-center rounded-md text-[10px] font-medium h-6 px-2 shrink-0 "+(((X=r[8])==null?void 0:X.id)===r[62].id?"bg-primary text-primary-foreground":"border border-input bg-background")),o(e,"class",G="w-full flex items-center gap-3 p-2 rounded border border-border hover:bg-accent/50 text-left "+(((K=r[8])==null?void 0:K.id)===r[62].id?"border-primary bg-accent/30":""))},m(X,K){S(X,e,K),J.m(e,null),s(e,t),s(e,l),s(l,a),s(l,n),s(l,u),s(e,c),s(e,f),s(f,g),s(f,k),s(f,_),s(f,w),s(e,P),s(e,O),s(O,j),s(O,C),s(e,N),s(e,I),s(I,F),s(e,re),R||(U=me(e,"click",_e),R=!0)},p(X,K){var q,$,oe,ge,ne;r=X,Y===(Y=we(r))&&J?J.p(r,K):(J.d(1),J=Y(r),J&&(J.c(),J.m(e,t))),K[0]&128&&m!==(m=(r[62].name||r[62].title)+"")&&se(g,m),K[0]&128&&b!==(b=(((q=r[62].firstAirDate)==null?void 0:q.slice(0,4))||(($=r[62].releaseDate)==null?void 0:$.slice(0,4)))+"")&&se(_,b),K[0]&128&&V!==(V=r[62].id+"")&&se(C,V),K[0]&384&&H!==(H=((oe=r[8])==null?void 0:oe.id)===r[62].id?"已选":"选用")&&se(F,H),K[0]&384&&B!==(B="inline-flex items-center justify-center rounded-md text-[10px] font-medium h-6 px-2 shrink-0 "+(((ge=r[8])==null?void 0:ge.id)===r[62].id?"bg-primary text-primary-foreground":"border border-input bg-background"))&&o(I,"class",B),K[0]&384&&G!==(G="w-full flex items-center gap-3 p-2 rounded border border-border hover:bg-accent/50 text-left "+(((ne=r[8])==null?void 0:ne.id)===r[62].id?"border-primary bg-accent/30":""))&&o(e,"class",G)},d(X){X&&d(e),J.d(),R=!1,U()}}}function Il(r){let e;return{c(){e=T("立即入库")},l(t){e=D(t,"立即入库")},m(t,l){S(t,e,l)},d(t){t&&d(e)}}}function Al(r){let e,t,l;return{c(){e=le("svg"),t=le("path"),l=T(`
                处理中...`),this.h()},l(a){e=te(a,"svg",{class:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var i=v(e);t=te(i,"path",{d:!0}),v(t).forEach(d),i.forEach(d),l=D(a,`
                处理中...`),this.h()},h(){o(t,"d","M21 12a9 9 0 1 1-6.219-8.56"),o(e,"class","h-4 w-4 animate-spin mr-2"),o(e,"viewBox","0 0 24 24"),o(e,"fill","none"),o(e,"stroke","currentColor"),o(e,"stroke-width","2")},m(a,i){S(a,e,i),s(e,t),S(a,l,i)},d(a){a&&(d(e),d(l))}}}function Yt(r){let e,t,l,a="选择消歧方式",i,n,u,c=r[3].size+"",f,m,g,k,b,_,w,P,O='<div class="font-medium">手动匹配</div> <div class="text-sm text-muted-foreground">逐个确认每个文件的 TMDB 匹配结果</div>',j,V,C,N,I,H,F='<div class="font-medium">AI 自动</div> <div class="text-sm text-muted-foreground">使用 AI 自动选择最佳匹配</div>',B,re,G,R,U="取消",we,Y,J="开始处理",_e,fe,ie,De,X,K;return De=ol(r[51][0]),{c(){e=p("div"),t=p("div"),l=p("h3"),l.textContent=a,i=E(),n=p("p"),u=T("已选择 "),f=T(c),m=T(" 个文件，请选择如何处理多个匹配结果的情况："),g=E(),k=p("div"),b=p("label"),_=p("input"),w=E(),P=p("div"),P.innerHTML=O,V=E(),C=p("label"),N=p("input"),I=E(),H=p("div"),H.innerHTML=F,re=E(),G=p("div"),R=p("button"),R.textContent=U,we=E(),Y=p("button"),Y.textContent=J,this.h()},l(q){e=h(q,"DIV",{class:!0});var $=v(e);t=h($,"DIV",{class:!0});var oe=v(t);l=h(oe,"H3",{class:!0,"data-svelte-h":!0}),z(l)!=="svelte-uq0mp0"&&(l.textContent=a),i=y(oe),n=h(oe,"P",{class:!0});var ge=v(n);u=D(ge,"已选择 "),f=D(ge,c),m=D(ge," 个文件，请选择如何处理多个匹配结果的情况："),ge.forEach(d),g=y(oe),k=h(oe,"DIV",{class:!0});var ne=v(k);b=h(ne,"LABEL",{class:!0});var ve=v(b);_=h(ve,"INPUT",{type:!0,class:!0}),w=y(ve),P=h(ve,"DIV",{"data-svelte-h":!0}),z(P)!=="svelte-9xjftn"&&(P.innerHTML=O),ve.forEach(d),V=y(ne),C=h(ne,"LABEL",{class:!0});var ke=v(C);N=h(ke,"INPUT",{type:!0,class:!0}),I=y(ke),H=h(ke,"DIV",{"data-svelte-h":!0}),z(H)!=="svelte-1kjdbqu"&&(H.innerHTML=F),ke.forEach(d),ne.forEach(d),re=y(oe),G=h(oe,"DIV",{class:!0});var Se=v(G);R=h(Se,"BUTTON",{class:!0,"data-svelte-h":!0}),z(R)!=="svelte-em6l26"&&(R.textContent=U),we=y(Se),Y=h(Se,"BUTTON",{class:!0,"data-svelte-h":!0}),z(Y)!=="svelte-1fvjn3"&&(Y.textContent=J),Se.forEach(d),oe.forEach(d),$.forEach(d),this.h()},h(){o(l,"class","text-lg font-semibold mb-4"),o(n,"class","text-sm text-muted-foreground mb-4"),o(_,"type","radio"),_.__value="manual",Ue(_,_.__value),o(_,"class","mt-1 accent-primary"),o(b,"class",j="flex items-start gap-3 p-3 rounded-lg border border-border hover:bg-accent/50 cursor-pointer "+(r[18]==="manual"?"border-primary bg-accent/30":"")),o(N,"type","radio"),N.__value="ai",Ue(N,N.__value),o(N,"class","mt-1 accent-primary"),o(C,"class",B="flex items-start gap-3 p-3 rounded-lg border border-border hover:bg-accent/50 cursor-pointer "+(r[18]==="ai"?"border-primary bg-accent/30":"")),o(k,"class","space-y-3 mb-6"),o(R,"class","inline-flex items-center justify-center rounded-md text-sm font-medium h-9 px-4 border border-input bg-background hover:bg-accent"),o(Y,"class","inline-flex items-center justify-center rounded-md text-sm font-medium h-9 px-4 bg-primary text-primary-foreground hover:opacity-90"),o(G,"class","flex justify-end gap-2"),o(t,"class","w-full max-w-md rounded-lg border border-border bg-card p-6 shadow-lg"),o(e,"class","fixed inset-0 z-50 flex items-center justify-center bg-background/80 backdrop-blur-sm"),De.p(_,N)},m(q,$){S(q,e,$),s(e,t),s(t,l),s(t,i),s(t,n),s(n,u),s(n,f),s(n,m),s(t,g),s(t,k),s(k,b),s(b,_),_.checked=_.__value===r[18],s(b,w),s(b,P),s(k,V),s(k,C),s(C,N),N.checked=N.__value===r[18],s(C,I),s(C,H),s(t,re),s(t,G),s(G,R),s(G,we),s(G,Y),ie=!0,X||(K=[me(_,"change",r[50]),me(N,"change",r[52]),me(R,"click",r[53]),me(Y,"click",r[34])],X=!0)},p(q,$){(!ie||$[0]&8)&&c!==(c=q[3].size+"")&&se(f,c),$[0]&262144&&(_.checked=_.__value===q[18]),(!ie||$[0]&262144&&j!==(j="flex items-start gap-3 p-3 rounded-lg border border-border hover:bg-accent/50 cursor-pointer "+(q[18]==="manual"?"border-primary bg-accent/30":"")))&&o(b,"class",j),$[0]&262144&&(N.checked=N.__value===q[18]),(!ie||$[0]&262144&&B!==(B="flex items-start gap-3 p-3 rounded-lg border border-border hover:bg-accent/50 cursor-pointer "+(q[18]==="ai"?"border-primary bg-accent/30":"")))&&o(C,"class",B)},i(q){ie||(q&&vt(()=>{ie&&(_e||(_e=Je(t,xt,{duration:200,start:.95,easing:kt},!0)),_e.run(1))}),q&&vt(()=>{ie&&(fe||(fe=Je(e,wt,{duration:200},!0)),fe.run(1))}),ie=!0)},o(q){q&&(_e||(_e=Je(t,xt,{duration:200,start:.95,easing:kt},!1)),_e.run(0)),q&&(fe||(fe=Je(e,wt,{duration:200},!1)),fe.run(0)),ie=!1},d(q){q&&d(e),q&&_e&&_e.end(),q&&fe&&fe.end(),De.r(),X=!1,nt(K)}}}function Jt(r){let e,t,l,a="移动预览",i,n,u,c,f="关闭",m,g,k,b,_,w,P,O,j;function V(I,H){return I[24]?Vl:I[22].length===0?Ml:Bl}let C=V(r),N=C(r);return{c(){e=p("div"),t=p("div"),l=p("h3"),l.textContent=a,i=E(),N.c(),n=E(),u=p("div"),c=p("button"),c.textContent=f,m=E(),g=p("button"),k=T("确认执行"),this.h()},l(I){e=h(I,"DIV",{class:!0});var H=v(e);t=h(H,"DIV",{class:!0});var F=v(t);l=h(F,"H3",{class:!0,"data-svelte-h":!0}),z(l)!=="svelte-tu8jz8"&&(l.textContent=a),i=y(F),N.l(F),n=y(F),u=h(F,"DIV",{class:!0});var B=v(u);c=h(B,"BUTTON",{class:!0,"data-svelte-h":!0}),z(c)!=="svelte-p6p3sc"&&(c.textContent=f),m=y(B),g=h(B,"BUTTON",{class:!0});var re=v(g);k=D(re,"确认执行"),re.forEach(d),B.forEach(d),F.forEach(d),H.forEach(d),this.h()},h(){o(l,"class","text-lg font-semibold mb-4"),o(c,"class","inline-flex items-center justify-center rounded-md text-sm font-medium h-9 px-4 border border-input bg-background hover:bg-accent"),o(g,"class","inline-flex items-center justify-center rounded-md text-sm font-medium h-9 px-4 bg-primary text-primary-foreground hover:opacity-90 disabled:opacity-50"),g.disabled=b=r[22].length===0||r[24],o(u,"class","flex justify-end gap-2 pt-4 border-t border-border"),o(t,"class","w-full max-w-2xl rounded-lg border border-border bg-card p-6 shadow-lg max-h-[80vh] flex flex-col"),o(e,"class","fixed inset-0 z-50 flex items-center justify-center bg-background/80 backdrop-blur-sm")},m(I,H){S(I,e,H),s(e,t),s(t,l),s(t,i),N.m(t,null),s(t,n),s(t,u),s(u,c),s(u,m),s(u,g),s(g,k),P=!0,O||(j=[me(c,"click",r[54]),me(g,"click",r[55])],O=!0)},p(I,H){C===(C=V(I))&&N?N.p(I,H):(N.d(1),N=C(I),N&&(N.c(),N.m(t,n))),(!P||H[0]&20971520&&b!==(b=I[22].length===0||I[24]))&&(g.disabled=b)},i(I){P||(I&&vt(()=>{P&&(_||(_=Je(t,xt,{duration:200,start:.95,easing:kt},!0)),_.run(1))}),I&&vt(()=>{P&&(w||(w=Je(e,wt,{duration:200},!0)),w.run(1))}),P=!0)},o(I){I&&(_||(_=Je(t,xt,{duration:200,start:.95,easing:kt},!1)),_.run(0)),I&&(w||(w=Je(e,wt,{duration:200},!1)),w.run(0)),P=!1},d(I){I&&d(e),N.d(),I&&_&&_.end(),I&&w&&w.end(),O=!1,nt(j)}}}function Bl(r){let e,t,l=r[23]&&Xt(r),a=Xe(r[22]),i=[];for(let n=0;n<a.length;n+=1)i[n]=ll(Ot(r,a,n));return{c(){l&&l.c(),e=E(),t=p("div");for(let n=0;n<i.length;n+=1)i[n].c();this.h()},l(n){l&&l.l(n),e=y(n),t=h(n,"DIV",{class:!0});var u=v(t);for(let c=0;c<i.length;c+=1)i[c].l(u);u.forEach(d),this.h()},h(){o(t,"class","flex-1 overflow-y-auto space-y-2 mb-4")},m(n,u){l&&l.m(n,u),S(n,e,u),S(n,t,u);for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(t,null)},p(n,u){if(n[23]?l?l.p(n,u):(l=Xt(n),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null),u[0]&4194304){a=Xe(n[22]);let c;for(c=0;c<a.length;c+=1){const f=Ot(n,a,c);i[c]?i[c].p(f,u):(i[c]=ll(f),i[c].c(),i[c].m(t,null))}for(;c<i.length;c+=1)i[c].d(1);i.length=a.length}},d(n){n&&(d(e),d(t)),l&&l.d(n),yt(i,n)}}}function Ml(r){let e,t="无法生成预览";return{c(){e=p("div"),e.textContent=t,this.h()},l(l){e=h(l,"DIV",{class:!0,"data-svelte-h":!0}),z(e)!=="svelte-1bcavr8"&&(e.textContent=t),this.h()},h(){o(e,"class","flex-1 flex items-center justify-center py-8 text-muted-foreground")},m(l,a){S(l,e,a)},p:Qe,d(l){l&&d(e)}}}function Vl(r){let e,t='<svg class="h-6 w-6 animate-spin text-primary" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12a9 9 0 1 1-6.219-8.56"></path></svg> <span class="ml-2 text-muted-foreground">加载中...</span>';return{c(){e=p("div"),e.innerHTML=t,this.h()},l(l){e=h(l,"DIV",{class:!0,"data-svelte-h":!0}),z(e)!=="svelte-rr948t"&&(e.innerHTML=t),this.h()},h(){o(e,"class","flex-1 flex items-center justify-center py-8")},m(l,a){S(l,e,a)},p:Qe,d(l){l&&d(e)}}}function Xt(r){let e,t,l,a,i=r[23].filesMoving+"",n,u,c,f,m,g=r[23].nfoCreating+"",k,b,_=r[23].nfoOverwriting>0&&$t(r);return{c(){e=p("div"),t=p("span"),l=T("移动: "),a=p("span"),n=T(i),u=E(),c=p("span"),f=T("创建 NFO: "),m=p("span"),k=T(g),b=E(),_&&_.c(),this.h()},l(w){e=h(w,"DIV",{class:!0});var P=v(e);t=h(P,"SPAN",{class:!0});var O=v(t);l=D(O,"移动: "),a=h(O,"SPAN",{class:!0});var j=v(a);n=D(j,i),j.forEach(d),O.forEach(d),u=y(P),c=h(P,"SPAN",{class:!0});var V=v(c);f=D(V,"创建 NFO: "),m=h(V,"SPAN",{class:!0});var C=v(m);k=D(C,g),C.forEach(d),V.forEach(d),b=y(P),_&&_.l(P),P.forEach(d),this.h()},h(){o(a,"class","text-foreground font-medium"),o(t,"class","text-muted-foreground"),o(m,"class","text-foreground font-medium"),o(c,"class","text-muted-foreground"),o(e,"class","flex gap-4 mb-4 text-xs")},m(w,P){S(w,e,P),s(e,t),s(t,l),s(t,a),s(a,n),s(e,u),s(e,c),s(c,f),s(c,m),s(m,k),s(e,b),_&&_.m(e,null)},p(w,P){P[0]&8388608&&i!==(i=w[23].filesMoving+"")&&se(n,i),P[0]&8388608&&g!==(g=w[23].nfoCreating+"")&&se(k,g),w[23].nfoOverwriting>0?_?_.p(w,P):(_=$t(w),_.c(),_.m(e,null)):_&&(_.d(1),_=null)},d(w){w&&d(e),_&&_.d()}}}function $t(r){let e,t,l,a=r[23].nfoOverwriting+"",i;return{c(){e=p("span"),t=T("覆盖 NFO: "),l=p("span"),i=T(a),this.h()},l(n){e=h(n,"SPAN",{class:!0});var u=v(e);t=D(u,"覆盖 NFO: "),l=h(u,"SPAN",{class:!0});var c=v(l);i=D(c,a),c.forEach(d),u.forEach(d),this.h()},h(){o(l,"class","font-medium"),o(e,"class","text-yellow-500")},m(n,u){S(n,e,u),s(e,t),s(e,l),s(l,i)},p(n,u){u[0]&8388608&&a!==(a=n[23].nfoOverwriting+"")&&se(i,a)},d(n){n&&d(e)}}}function Ol(r){let e,t,l,a,i,n,u="下载海报";return{c(){e=le("svg"),t=le("rect"),l=le("circle"),a=le("path"),i=E(),n=p("span"),n.textContent=u,this.h()},l(c){e=te(c,"svg",{class:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var f=v(e);t=te(f,"rect",{width:!0,height:!0,x:!0,y:!0,rx:!0}),v(t).forEach(d),l=te(f,"circle",{cx:!0,cy:!0,r:!0}),v(l).forEach(d),a=te(f,"path",{d:!0}),v(a).forEach(d),f.forEach(d),i=y(c),n=h(c,"SPAN",{class:!0,"data-svelte-h":!0}),z(n)!=="svelte-1w0n2rh"&&(n.textContent=u),this.h()},h(){o(t,"width","18"),o(t,"height","18"),o(t,"x","3"),o(t,"y","3"),o(t,"rx","2"),o(l,"cx","9"),o(l,"cy","9"),o(l,"r","2"),o(a,"d","m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"),o(e,"class","h-4 w-4 text-cyan-500"),o(e,"viewBox","0 0 24 24"),o(e,"fill","none"),o(e,"stroke","currentColor"),o(e,"stroke-width","2"),o(n,"class","text-cyan-500 font-medium")},m(c,f){S(c,e,f),s(e,t),s(e,l),s(e,a),S(c,i,f),S(c,n,f)},d(c){c&&(d(e),d(i),d(n))}}}function Ll(r){let e,t,l,a,i,n,u="创建目录";return{c(){e=le("svg"),t=le("path"),l=le("path"),a=le("path"),i=E(),n=p("span"),n.textContent=u,this.h()},l(c){e=te(c,"svg",{class:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var f=v(e);t=te(f,"path",{d:!0}),v(t).forEach(d),l=te(f,"path",{d:!0}),v(l).forEach(d),a=te(f,"path",{d:!0}),v(a).forEach(d),f.forEach(d),i=y(c),n=h(c,"SPAN",{class:!0,"data-svelte-h":!0}),z(n)!=="svelte-tgaqck"&&(n.textContent=u),this.h()},h(){o(t,"d","M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"),o(l,"d","M12 10v6"),o(a,"d","m9 13 3-3 3 3"),o(e,"class","h-4 w-4 text-purple-500"),o(e,"viewBox","0 0 24 24"),o(e,"fill","none"),o(e,"stroke","currentColor"),o(e,"stroke-width","2"),o(n,"class","text-purple-500 font-medium")},m(c,f){S(c,e,f),s(e,t),s(e,l),s(e,a),S(c,i,f),S(c,n,f)},d(c){c&&(d(e),d(i),d(n))}}}function jl(r){let e,t,l,a,i,n="创建 NFO";return{c(){e=le("svg"),t=le("path"),l=le("path"),a=E(),i=p("span"),i.textContent=n,this.h()},l(u){e=te(u,"svg",{class:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var c=v(e);t=te(c,"path",{d:!0}),v(t).forEach(d),l=te(c,"path",{d:!0}),v(l).forEach(d),c.forEach(d),a=y(u),i=h(u,"SPAN",{class:!0,"data-svelte-h":!0}),z(i)!=="svelte-1a54wwq"&&(i.textContent=n),this.h()},h(){o(t,"d","M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"),o(l,"d","M14 2v4a2 2 0 0 0 2 2h4"),o(e,"class","h-4 w-4 text-blue-500"),o(e,"viewBox","0 0 24 24"),o(e,"fill","none"),o(e,"stroke","currentColor"),o(e,"stroke-width","2"),o(i,"class","text-blue-500 font-medium")},m(u,c){S(u,e,c),s(e,t),s(e,l),S(u,a,c),S(u,i,c)},d(u){u&&(d(e),d(a),d(i))}}}function Hl(r){let e,t,l,a,i,n="移动";return{c(){e=le("svg"),t=le("path"),l=le("path"),a=E(),i=p("span"),i.textContent=n,this.h()},l(u){e=te(u,"svg",{class:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var c=v(e);t=te(c,"path",{d:!0}),v(t).forEach(d),l=te(c,"path",{d:!0}),v(l).forEach(d),c.forEach(d),a=y(u),i=h(u,"SPAN",{class:!0,"data-svelte-h":!0}),z(i)!=="svelte-s1w5iw"&&(i.textContent=n),this.h()},h(){o(t,"d","M5 12h14"),o(l,"d","m12 5 7 7-7 7"),o(e,"class","h-4 w-4 text-green-500"),o(e,"viewBox","0 0 24 24"),o(e,"fill","none"),o(e,"stroke","currentColor"),o(e,"stroke-width","2"),o(i,"class","text-green-500 font-medium")},m(u,c){S(u,e,c),s(e,t),s(e,l),S(u,a,c),S(u,i,c)},d(u){u&&(d(e),d(a),d(i))}}}function el(r){let e,t="覆盖";return{c(){e=p("span"),e.textContent=t,this.h()},l(l){e=h(l,"SPAN",{class:!0,"data-svelte-h":!0}),z(e)!=="svelte-alotm8"&&(e.textContent=t),this.h()},h(){o(e,"class","text-[10px] text-yellow-500 border border-yellow-500/50 rounded px-1")},m(l,a){S(l,e,a)},d(l){l&&d(e)}}}function tl(r){let e,t=r[59].source+"",l,a,i,n='<svg class="h-3 w-3 text-muted-foreground" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m9 18 6-6-6-6"></path></svg>';return{c(){e=p("div"),l=T(t),a=E(),i=p("div"),i.innerHTML=n,this.h()},l(u){e=h(u,"DIV",{class:!0});var c=v(e);l=D(c,t),c.forEach(d),a=y(u),i=h(u,"DIV",{class:!0,"data-svelte-h":!0}),z(i)!=="svelte-p6nn8x"&&(i.innerHTML=n),this.h()},h(){o(e,"class","font-mono text-muted-foreground truncate"),o(i,"class","flex items-center gap-1 my-1")},m(u,c){S(u,e,c),s(e,l),S(u,a,c),S(u,i,c)},p(u,c){c[0]&4194304&&t!==(t=u[59].source+"")&&se(l,t)},d(u){u&&(d(e),d(a),d(i))}}}function ll(r){let e,t,l,a,i,n,u=r[59].destination+"",c,f;function m(w,P){if(w[59].type==="move")return Hl;if(w[59].type==="create-nfo")return jl;if(w[59].type==="create-dir")return Ll;if(w[59].type==="download-poster")return Ol}let g=m(r),k=g&&g(r),b=r[59].willOverwrite&&el(),_=r[59].source&&tl(r);return{c(){e=p("div"),t=p("div"),k&&k.c(),l=E(),b&&b.c(),a=E(),_&&_.c(),i=E(),n=p("div"),c=T(u),f=E(),this.h()},l(w){e=h(w,"DIV",{class:!0});var P=v(e);t=h(P,"DIV",{class:!0});var O=v(t);k&&k.l(O),l=y(O),b&&b.l(O),O.forEach(d),a=y(P),_&&_.l(P),i=y(P),n=h(P,"DIV",{class:!0});var j=v(n);c=D(j,u),j.forEach(d),f=y(P),P.forEach(d),this.h()},h(){o(t,"class","flex items-center gap-2 mb-1"),o(n,"class","font-mono truncate"),o(e,"class","p-3 rounded-lg border border-border text-xs")},m(w,P){S(w,e,P),s(e,t),k&&k.m(t,null),s(t,l),b&&b.m(t,null),s(e,a),_&&_.m(e,null),s(e,i),s(e,n),s(n,c),s(e,f)},p(w,P){g!==(g=m(w))&&(k&&k.d(1),k=g&&g(w),k&&(k.c(),k.m(t,l))),w[59].willOverwrite?b||(b=el(),b.c(),b.m(t,null)):b&&(b.d(1),b=null),w[59].source?_?_.p(w,P):(_=tl(w),_.c(),_.m(e,i)):_&&(_.d(1),_=null),P[0]&4194304&&u!==(u=w[59].destination+"")&&se(c,u)},d(w){w&&d(e),k&&k.d(),b&&b.d(),_&&_.d()}}}function Fl(r){let e,t,l,a='<h2 class="text-sm font-medium">目录</h2>',i,n,u,c,f,m=`<svg class="h-3 w-3 mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg>
        刷新`,g,k,b,_,w,P,O=r[6].split("/").pop()+"",j,V,C,N,I="过滤:",H,F,B,re="全部",G,R="未处理",U,we="已处理",Y,J,_e="搜索:",fe,ie,De,X,K="刷新",q,$,oe,ge,ne,ve,ke,Se,ze,Ie,Me="文件名",Ge,Ve,qe="解析结果",Oe,He,Re,Pe,Ze,Ee,Ne,$e="选中文件详情 / 匹配结果",Ke,x,M,W,Z,be;function Fe(A,ae){return A[5]?vl:A[2].length===0?_l:pl}let Le=Fe(r),ye=Le(r),Ce=Xe(r[25]),ce=[];for(let A=0;A<Ce.length;A+=1)ce[A]=Zt(jt(r,Ce,A));function at(A,ae){return A[14]?yl:A[19].length>0?wl:xl}let et=at(r),Ae=et(r);function tt(A,ae){return A[4]?Cl:El}let Te=tt(r),de=Te(r),he=r[17]&&Yt(r),Q=r[21]&&Jt(r);return{c(){e=p("div"),t=p("div"),l=p("div"),l.innerHTML=a,i=E(),n=p("div"),ye.c(),u=E(),c=p("div"),f=p("button"),f.innerHTML=m,g=E(),k=p("div"),b=p("div"),_=p("div"),w=p("h2"),P=T("当前目录: "),j=T(O),V=E(),C=p("div"),N=p("span"),N.textContent=I,H=E(),F=p("select"),B=p("option"),B.textContent=re,G=p("option"),G.textContent=R,U=p("option"),U.textContent=we,Y=E(),J=p("span"),J.textContent=_e,fe=E(),ie=p("input"),De=E(),X=p("button"),X.textContent=K,q=E(),$=p("div"),oe=p("table"),ge=p("thead"),ne=p("tr"),ve=p("th"),ke=p("input"),ze=E(),Ie=p("th"),Ie.textContent=Me,Ge=E(),Ve=p("th"),Ve.textContent=qe,Oe=E(),He=p("tbody");for(let A=0;A<ce.length;A+=1)ce[A].c();Re=E(),Pe=p("div"),Ae.c(),Ze=E(),Ee=p("div"),Ne=p("h3"),Ne.textContent=$e,Ke=E(),de.c(),x=E(),he&&he.c(),M=E(),Q&&Q.c(),W=pt(),this.h()},l(A){e=h(A,"DIV",{class:!0});var ae=v(e);t=h(ae,"DIV",{class:!0});var ee=v(t);l=h(ee,"DIV",{class:!0,"data-svelte-h":!0}),z(l)!=="svelte-ru9pwd"&&(l.innerHTML=a),i=y(ee),n=h(ee,"DIV",{class:!0});var L=v(n);ye.l(L),L.forEach(d),u=y(ee),c=h(ee,"DIV",{class:!0});var ue=v(c);f=h(ue,"BUTTON",{class:!0,"data-svelte-h":!0}),z(f)!=="svelte-e7v5tm"&&(f.innerHTML=m),ue.forEach(d),ee.forEach(d),g=y(ae),k=h(ae,"DIV",{class:!0});var pe=v(k);b=h(pe,"DIV",{class:!0});var xe=v(b);_=h(xe,"DIV",{class:!0});var Ye=v(_);w=h(Ye,"H2",{class:!0});var ot=v(w);P=D(ot,"当前目录: "),j=D(ot,O),ot.forEach(d),V=y(Ye),C=h(Ye,"DIV",{class:!0});var Be=v(C);N=h(Be,"SPAN",{class:!0,"data-svelte-h":!0}),z(N)!=="svelte-1ri8e3i"&&(N.textContent=I),H=y(Be),F=h(Be,"SELECT",{class:!0});var lt=v(F);B=h(lt,"OPTION",{"data-svelte-h":!0}),z(B)!=="svelte-zuxolj"&&(B.textContent=re),G=h(lt,"OPTION",{"data-svelte-h":!0}),z(G)!=="svelte-1kzbqsb"&&(G.textContent=R),U=h(lt,"OPTION",{"data-svelte-h":!0}),z(U)!=="svelte-wv6zl2"&&(U.textContent=we),lt.forEach(d),Y=y(Be),J=h(Be,"SPAN",{class:!0,"data-svelte-h":!0}),z(J)!=="svelte-1falrlf"&&(J.textContent=_e),fe=y(Be),ie=h(Be,"INPUT",{type:!0,class:!0}),De=y(Be),X=h(Be,"BUTTON",{class:!0,"data-svelte-h":!0}),z(X)!=="svelte-1qa5v7m"&&(X.textContent=K),Be.forEach(d),Ye.forEach(d),q=y(xe),$=h(xe,"DIV",{class:!0});var it=v($);oe=h(it,"TABLE",{class:!0});var st=v(oe);ge=h(st,"THEAD",{class:!0});var ut=v(ge);ne=h(ut,"TR",{});var We=v(ne);ve=h(We,"TH",{class:!0});var ct=v(ve);ke=h(ct,"INPUT",{type:!0,class:!0}),ct.forEach(d),ze=y(We),Ie=h(We,"TH",{class:!0,"data-svelte-h":!0}),z(Ie)!=="svelte-1dadh28"&&(Ie.textContent=Me),Ge=y(We),Ve=h(We,"TH",{class:!0,"data-svelte-h":!0}),z(Ve)!=="svelte-9n20f4"&&(Ve.textContent=qe),We.forEach(d),ut.forEach(d),Oe=y(st),He=h(st,"TBODY",{});var _t=v(He);for(let je=0;je<ce.length;je+=1)ce[je].l(_t);_t.forEach(d),st.forEach(d),it.forEach(d),Re=y(xe),Pe=h(xe,"DIV",{class:!0});var dt=v(Pe);Ae.l(dt),dt.forEach(d),xe.forEach(d),Ze=y(pe),Ee=h(pe,"DIV",{class:!0});var rt=v(Ee);Ne=h(rt,"H3",{class:!0,"data-svelte-h":!0}),z(Ne)!=="svelte-190bux"&&(Ne.textContent=$e),Ke=y(rt),de.l(rt),rt.forEach(d),pe.forEach(d),ae.forEach(d),x=y(A),he&&he.l(A),M=y(A),Q&&Q.l(A),W=pt(),this.h()},h(){o(l,"class","border-b border-border p-3"),o(n,"class","flex-1 overflow-y-auto"),o(f,"class","flex-1 inline-flex items-center justify-center rounded-md text-xs font-medium h-8 px-3 border border-input bg-background hover:bg-accent"),o(c,"class","flex gap-2 border-t border-border p-3"),o(t,"class","w-72 flex flex-col border-r border-border bg-card"),o(w,"class","text-sm font-medium"),o(N,"class","text-xs text-muted-foreground"),B.__value="all",Ue(B,B.__value),G.__value="unprocessed",Ue(G,G.__value),U.__value="processed",Ue(U,U.__value),o(F,"class","h-8 rounded-md border border-input bg-background px-2 text-xs"),r[0]===void 0&&vt(()=>r[41].call(F)),o(J,"class","text-xs text-muted-foreground"),o(ie,"type","text"),o(ie,"class","h-8 w-32 rounded-md border border-input bg-background px-2 text-xs"),o(X,"class","inline-flex items-center justify-center rounded-md text-xs font-medium h-8 px-3 border border-input bg-background hover:bg-accent"),o(C,"class","ml-auto flex items-center gap-2"),o(_,"class","flex items-center gap-4 border-b border-border bg-card px-4 py-2"),o(ke,"type","checkbox"),o(ke,"class","h-4 w-4 rounded border-input accent-primary"),ke.checked=Se=r[3].size===r[25].length&&r[25].length>0,o(ve,"class","w-10 p-2 text-left"),o(Ie,"class","p-2 text-left font-medium text-muted-foreground text-xs"),o(Ve,"class","p-2 text-left font-medium text-muted-foreground text-xs"),o(ge,"class","sticky top-0 bg-card border-b border-border"),o(oe,"class","w-full text-sm"),o($,"class","flex-1 overflow-y-auto"),o(Pe,"class","flex items-center gap-2 border-t border-border bg-card px-4 py-2 flex-wrap"),o(b,"class","flex-1 flex flex-col overflow-hidden"),o(Ne,"class","mb-3 text-sm font-medium"),o(Ee,"class","h-72 border-t border-border bg-card p-4 overflow-y-auto"),o(k,"class","flex flex-1 flex-col"),o(e,"class","flex h-[calc(100vh-64px)]")},m(A,ae){S(A,e,ae),s(e,t),s(t,l),s(t,i),s(t,n),ye.m(n,null),s(t,u),s(t,c),s(c,f),s(e,g),s(e,k),s(k,b),s(b,_),s(_,w),s(w,P),s(w,j),s(_,V),s(_,C),s(C,N),s(C,H),s(C,F),s(F,B),s(F,G),s(F,U),St(F,r[0],!0),s(C,Y),s(C,J),s(C,fe),s(C,ie),Ue(ie,r[1]),s(C,De),s(C,X),s(b,q),s(b,$),s($,oe),s(oe,ge),s(ge,ne),s(ne,ve),s(ve,ke),s(ne,ze),s(ne,Ie),s(ne,Ge),s(ne,Ve),s(oe,Oe),s(oe,He);for(let ee=0;ee<ce.length;ee+=1)ce[ee]&&ce[ee].m(He,null);s(b,Re),s(b,Pe),Ae.m(Pe,null),s(k,Ze),s(k,Ee),s(Ee,Ne),s(Ee,Ke),de.m(Ee,null),S(A,x,ae),he&&he.m(A,ae),S(A,M,ae),Q&&Q.m(A,ae),S(A,W,ae),Z||(be=[me(f,"click",r[26]),me(F,"change",r[41]),me(ie,"input",r[42]),me(X,"click",r[26]),me(ke,"change",r[30])],Z=!0)},p(A,ae){if(Le===(Le=Fe(A))&&ye?ye.p(A,ae):(ye.d(1),ye=Le(A),ye&&(ye.c(),ye.m(n,null))),ae[0]&64&&O!==(O=A[6].split("/").pop()+"")&&se(j,O),ae[0]&1&&St(F,A[0]),ae[0]&2&&ie.value!==A[1]&&Ue(ie,A[1]),ae[0]&33554440&&Se!==(Se=A[3].size===A[25].length&&A[25].length>0)&&(ke.checked=Se),ae[0]&838860808){Ce=Xe(A[25]);let ee;for(ee=0;ee<Ce.length;ee+=1){const L=jt(A,Ce,ee);ce[ee]?ce[ee].p(L,ae):(ce[ee]=Zt(L),ce[ee].c(),ce[ee].m(He,null))}for(;ee<ce.length;ee+=1)ce[ee].d(1);ce.length=Ce.length}et===(et=at(A))&&Ae?Ae.p(A,ae):(Ae.d(1),Ae=et(A),Ae&&(Ae.c(),Ae.m(Pe,null))),Te===(Te=tt(A))&&de?de.p(A,ae):(de.d(1),de=Te(A),de&&(de.c(),de.m(Ee,null))),A[17]?he?(he.p(A,ae),ae[0]&131072&&ht(he,1)):(he=Yt(A),he.c(),ht(he,1),he.m(M.parentNode,M)):he&&(At(),gt(he,1,1,()=>{he=null}),It()),A[21]?Q?(Q.p(A,ae),ae[0]&2097152&&ht(Q,1)):(Q=Jt(A),Q.c(),ht(Q,1),Q.m(W.parentNode,W)):Q&&(At(),gt(Q,1,1,()=>{Q=null}),It())},i(A){ht(he),ht(Q)},o(A){gt(he),gt(Q)},d(A){A&&(d(e),d(x),d(M),d(W)),ye.d(),yt(ce,A),Ae.d(),de.d(),he&&he.d(A),Q&&Q.d(A),Z=!1,nt(be)}}}function Ul(r,e,t){let l,a=[],i=[],n=[],u=new Set,c=null,f=!0,m="all",g="",k="",b=[],_=null,w=!1,P=0,O=!1,j="",V="",C=!1,N="",I={current:0,total:0},H=!1,F="manual",B=[],re=0,G=!1,R=[],U=null,we=!1;rl(async()=>{await Y()});async function Y(){t(5,f=!0);const x=k;try{t(2,a=await cl()),n=a.flatMap(W=>W.files);const M=a.find(W=>W.path===x);M?(t(6,k=M.path),t(39,i=M.files)):a.length>0?(t(6,k=a[0].path),t(39,i=a[0].files)):(t(6,k=""),t(39,i=[])),u.clear(),t(3,u),t(4,c=null),t(7,b=[]),t(8,_=null)}catch(M){console.error(M)}finally{t(5,f=!1)}}function J(x){t(6,k=x.path),t(39,i=x.files),u.clear(),t(3,u),t(4,c=null)}function _e(x,M){if(M.shiftKey&&u.size>0){const Z=i.map(ce=>ce.path),be=Array.from(u).pop(),Fe=Z.indexOf(be),Le=Z.indexOf(x),[ye,Ce]=Fe<Le?[Fe,Le]:[Le,Fe];for(let ce=ye;ce<=Ce;ce++)u.add(Z[ce])}else M.ctrlKey||M.metaKey?u.has(x)?u.delete(x):u.add(x):(u.clear(),u.add(x));t(3,u);const W=i.find(Z=>Z.path===x);W&&fe(W)}async function fe(x){if(t(4,c=x),t(7,b=[]),t(8,_=null),t(9,w=!1),t(10,P=0),x.parsed.title){x.kind==="movie"?t(13,V=`Library/Movies/${x.parsed.title}`):t(13,V=`Library/Shows/${x.parsed.title}/Season ${String(x.parsed.season||1).padStart(2,"0")}`),t(11,O=!0);try{const M=x.kind==="movie"?"movie":"tv",W=await Bt(x.path,M,x.parsed.title,x.parsed.year);if(t(7,b=W.candidates.map(Z=>({id:Z.id,name:Z.name,title:Z.name,posterPath:Z.posterPath,overview:Z.overview,firstAirDate:Z.date,releaseDate:Z.date}))),W.matched&&W.result){const Z=b.find(be=>be.id===W.result.id);Z?(t(8,_=Z),t(9,w=!0),t(10,P=W.result.score)):b.length>0&&t(8,_=b[0])}else b.length>0&&t(8,_=b[0])}catch(M){console.error(M)}finally{t(11,O=!1)}}}function ie(x){t(4,c=x),fe(x)}function De(){u.size===i.length?u.clear():i.forEach(x=>u.add(x.path)),t(3,u)}async function X(){if(!(!j.trim()||!c)){t(11,O=!0);try{const x=c.kind==="movie"?"movie":"tv";t(7,b=await dl(x,j)),b.length>0&&t(8,_=b[0])}catch(x){console.error(x)}finally{t(11,O=!1)}}}function K(x){t(8,_=x)}async function q(){u.size!==0&&t(17,H=!0)}async function $(){t(17,H=!1),t(14,C=!0),t(15,N="正在分析文件...");const x=n.filter(M=>u.has(M.path));t(19,B=[]),t(16,I={current:0,total:x.length});for(const M of x){t(15,N=`正在匹配 (${I.current+1}/${I.total}): ${M.relativePath}`);const W=M.kind==="movie"?"movie":"tv",Z=await Bt(M.path,W,M.parsed.title,M.parsed.year);Z.matched&&Z.result?B.push({file:M,candidates:Z.candidates.map(be=>({id:be.id,name:be.name||"",title:be.name,posterPath:be.posterPath}))}):Z.candidates.length>0&&B.push({file:M,candidates:Z.candidates.map(be=>({id:be.id,name:be.name||"",title:be.name,posterPath:be.posterPath}))}),t(16,I.current++,I),t(16,I)}if(F==="ai")await oe();else{if(t(20,re=0),B.length>0){const M=B[0];t(4,c=M.file),t(7,b=M.candidates),t(8,_=b[0])}t(14,C=!1),t(15,N="请为每个文件选择正确的匹配")}}async function oe(){t(15,N="正在使用 AI 处理..."),t(16,I={current:0,total:B.length});const x=B.map(W=>{var Z;return{sourcePath:W.file.path,kind:W.file.kind==="movie"?"movie":"tv",showName:W.file.parsed.title,tmdbId:(Z=W.candidates[0])==null?void 0:Z.id,season:W.file.parsed.season,episodes:W.file.parsed.episode!==void 0?[{source:W.file.path,episode:W.file.parsed.episode}]:void 0,candidates:W.candidates.map(be=>({id:be.id,name:be.name||be.title||""}))}}),M=await hl(x,"ai");t(15,N=M.success?`完成: ${M.processed} 成功, ${M.failed} 失败`:"批量处理失败"),await Y(),setTimeout(()=>{t(14,C=!1),t(15,N=""),t(19,B=[]),u.clear(),t(3,u)},2e3)}async function ge(){if(!_||re>=B.length)return;const x=B[re];t(14,C=!0),t(15,N=`正在处理 (${re+1}/${B.length}): ${x.file.relativePath}`);try{x.file.kind==="movie"?await Mt({sourcePath:x.file.path,tmdbId:_.id}):await Vt({sourcePath:x.file.path,showName:x.file.parsed.title||"",tmdbId:_.id,season:x.file.parsed.season||1,episodes:[{source:x.file.path,episode:x.file.parsed.episode||1}]})}catch(M){console.error(M)}if(t(20,re++,re),re<B.length){const M=B[re];t(4,c=M.file),t(7,b=M.candidates),t(8,_=b[0]),t(14,C=!1)}else t(15,N="批量处理完成"),await Y(),setTimeout(()=>{t(14,C=!1),t(15,N=""),t(19,B=[]),u.clear(),t(3,u)},2e3)}async function ne(){if(!(!c||!_)){t(14,C=!0),t(15,N=`正在处理: ${c.relativePath}`);try{if(c.kind==="movie"){const x=await Mt({sourcePath:c.path,tmdbId:_.id});t(15,N=x.success?"处理成功":x.message||"处理失败")}else{const x=await Vt({sourcePath:c.path,showName:c.parsed.title||"",tmdbId:_.id,season:c.parsed.season||1,episodes:[{source:c.path,episode:c.parsed.episode||1}]});t(15,N=x.success?"处理成功":x.message||"处理失败")}await Y()}catch(x){t(15,N="处理出错"),console.error(x)}setTimeout(()=>{t(14,C=!1),t(15,N="")},2e3)}}function ve(){if(t(20,re++,re),re<B.length){const x=B[re];t(4,c=x.file),t(7,b=x.candidates),t(8,_=b[0])}else t(15,N="批量处理完成"),Y(),setTimeout(()=>{t(15,N=""),t(19,B=[]),u.clear(),t(3,u)},2e3)}async function ke(){if(!(!c||!_)){t(24,we=!0),t(21,G=!0);try{const x=c.kind==="movie"?"movie":"tv",M=[{sourcePath:c.path,kind:x,tmdbId:_.id,showName:c.parsed.title,season:c.parsed.season,episodes:c.parsed.episode!==void 0?[{source:c.path,episode:c.parsed.episode}]:void 0}],W=await fl(M);t(22,R=W.actions),t(23,U=W.impactSummary)}catch(x){console.error(x),t(22,R=[]),t(23,U=null)}finally{t(24,we=!1)}}}const Se=[[]],ze=x=>J(x);function Ie(){m=il(this),t(0,m)}function Me(){g=this.value,t(1,g)}const Ge=x=>{u.has(x.path)?u.delete(x.path):u.add(x.path),t(3,u)},Ve=(x,M)=>_e(x.path,M),qe=x=>ie(x),Oe=()=>t(12,j=(c==null?void 0:c.parsed.title)||"");function He(){j=this.value,t(12,j)}const Re=x=>K(x);function Pe(){V=this.value,t(13,V)}function Ze(){F=this.__value,t(18,F)}function Ee(){F=this.__value,t(18,F)}const Ne=()=>t(17,H=!1),$e=()=>t(21,G=!1),Ke=()=>{t(21,G=!1),ne()};return r.$$.update=()=>{r.$$.dirty[0]&3|r.$$.dirty[1]&256&&t(25,l=i.filter(x=>!(m==="processed"&&!x.isProcessed||m==="unprocessed"&&x.isProcessed||g&&!x.relativePath.toLowerCase().includes(g.toLowerCase()))))},[m,g,a,u,c,f,k,b,_,w,P,O,j,V,C,N,I,H,F,B,re,G,R,U,we,l,Y,J,_e,ie,De,X,K,q,$,ge,ne,ve,ke,i,ze,Ie,Me,Ge,Ve,qe,Oe,He,Re,Pe,Ze,Se,Ee,Ne,$e,Ke]}class Kl extends nl{constructor(e){super(),al(this,e,Ul,Fl,sl,{},null,[-1,-1,-1])}}export{Kl as component};
