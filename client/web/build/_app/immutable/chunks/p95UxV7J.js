function p(s){return(s==null?void 0:s.length)!==void 0?s:Array.from(s)}const e="/api";async function h(){return(await(await fetch(`${e}/media/stats`)).json()).data}async function f(){return(await(await fetch(`${e}/media/tv?include=assets&group=status`)).json()).data||[]}async function m(){return(await(await fetch(`${e}/media/movies?include=assets`)).json()).data||[]}async function w(){return(await(await fetch(`${e}/media/inbox?view=dir`)).json()).data||[]}async function y(s,a,t){const n=new URLSearchParams({q:a});return(await(await fetch(`${e}/scrape/search/${s}?${n}`)).json()).data||[]}async function g(s=10){const t=await(await fetch(`${e}/tasks?limit=${s}`)).json();return{tasks:t.data||[],stats:t.stats||{total:0,pending:0,running:0,completed:0,failed:0,cancelled:0}}}async function l(s){return(await(await fetch(`${e}/tasks/${s}/cancel`,{method:"POST"})).json()).success}async function S(s,a="zh-CN"){var c;const n=await(await fetch(`${e}/scrape/supplement`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({showPath:s,language:a})})).json();return{success:n.success,message:n.error||((c=n.data)==null?void 0:c.message),taskId:n.taskId}}async function j(s,a,t,n){var d;const{season:c,episode:r,language:i="zh-CN"}=n||{},o=await(await fetch(`${e}/scrape/refresh`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({kind:s,path:a,tmdbId:t,season:c,episode:r,language:i})})).json();return{success:o.success,message:o.error||((d=o.data)==null?void 0:d.message),taskId:o.taskId}}async function T(s,a,t,n,c="zh-CN"){return(await(await fetch(`${e}/scrape/match`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:s,kind:a,title:t,year:n,language:c})})).json()).data||{matched:!1,candidates:[]}}async function $(s,a,t="zh-CN"){const c=await(await fetch(`${e}/scrape/batch`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:s,disambiguationMode:a,language:t})})).json();return{success:c.success,processed:c.processed||0,failed:c.failed||0,taskId:c.taskId}}async function O(s){const t=await(await fetch(`${e}/scrape/process/tv`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).json();return{success:t.success,message:t.error||t.message}}async function b(s){const t=await(await fetch(`${e}/scrape/process/movie`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).json();return{success:t.success,message:t.error||t.message}}async function v(s,a="zh-CN"){return(await(await fetch(`${e}/scrape/preview`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:s,language:a})})).json()).data||{actions:[],impactSummary:{filesMoving:0,nfoCreating:0,nfoOverwriting:0,postersDownloading:0,directoriesCreating:[]}}}function C(s){const a=new EventSource(`${e}/progress`);return a.addEventListener("progress",t=>{try{const n=JSON.parse(t.data);s(n)}catch{}}),a.onerror=()=>{setTimeout(()=>{a.close()},1e3)},()=>a.close()}export{g as a,w as b,l as c,T as d,p as e,h as f,O as g,v as h,$ as i,m as j,C as k,f as l,S as m,b as p,j as r,y as s};
